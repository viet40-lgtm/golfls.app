(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{9181:(e,t,l)=>{Promise.resolve().then(l.bind(l,2074))},2074:(e,t,l)=>{"use strict";l.d(t,{default:()=>$});var r=l(5155),a=l(2115),n=l(6046),s=l(9208),o=l(6758),i=l(5548),d=l(9609),c=l(7312),x=l(5828);let u=(0,x.createServerReference)("40ebac8213a49df5f28e787bd1324a82bf7c93118c",x.callServer,void 0,x.findSourceMapURL,"createPlayer");function p(e){let{allPlayers:t,selectedIds:l,playersInRound:n=[],onSelectionChange:s,isOpen:o,onClose:i,courseData:d,isAdmin:c=!1,frequentPlayerIds:x=[],currentUserId:p,hasMultipleGroups:g=!1}=e,[f,h]=(0,a.useState)(l),[m,b]=(0,a.useState)(""),[v,y]=(0,a.useState)(t),[w,j]=(0,a.useState)(!1),[N,k]=(0,a.useState)(!1),[S,C]=(0,a.useState)(""),[_,E]=(0,a.useState)({firstName:"",lastName:"",email:"",phone:"",handicapIndex:""});if((0,a.useEffect)(()=>{o&&(h(l),y(t),j(!1),C(""))},[o,t]),!o)return null;let R=e=>{h(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},I=async()=>{if(C(""),!_.firstName||!_.lastName||!_.email||!_.phone){C("All fields (Name, Email, Phone) are required.");return}k(!0);try{let e=parseFloat(_.handicapIndex),t=await u({firstName:_.firstName,lastName:_.lastName,email:_.email,phone:_.phone,handicapIndex:isNaN(e)?0:e}),l={id:t.id,name:t.name,index:t.handicapIndex,preferred_tee_box:t.preferredTeeBox,phone:t.phone};y(e=>[...e,l]),h(e=>[...e,t.id]),j(!1),b(""),E({firstName:"",lastName:"",email:"",phone:"",handicapIndex:""})}catch(e){C(e.message||"Failed to create player.")}finally{k(!1)}},L=v.filter(e=>{if(!m)return!0;let t=m.toLowerCase(),l=e.phone?e.phone.slice(-4):"",r=e.player_id?e.player_id.toLowerCase():"";return e.name.toLowerCase().includes(t)||l.includes(t)||r.includes(t)}),P=[...L].sort((e,t)=>{if(p&&e.id===p)return -1;if(p&&t.id===p)return 1;let l=null==x?void 0:x.includes(e.id),r=null==x?void 0:x.includes(t.id);if(l&&!r)return -1;if(!l&&r)return 1;let a=e.name.split(" ").pop()||e.name,n=t.name.split(" ").pop()||t.name;return a.localeCompare(n)}),M=e=>{let t;return void 0!==e.index&&d&&(d.courseName.toLowerCase().includes("city park north")&&e.preferred_tee_box&&(t=d.teeBoxes.find(t=>e.preferred_tee_box&&t.name.toLowerCase().includes(e.preferred_tee_box.toLowerCase()))),!t&&d.roundTeeBox&&(t=d.teeBoxes.find(e=>e.rating===d.roundTeeBox.rating&&e.slope===d.roundTeeBox.slope)),t||(t=d.teeBoxes.find(e=>e.name.toLowerCase().includes("white"))||d.teeBoxes[0]),t)?Math.round(e.index*t.slope/113+(t.rating-d.par)):null};return(0,r.jsx)("div",{className:"fixed inset-0 z-[200] flex items-center justify-center bg-black/60 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"bg-white w-full h-full flex flex-col shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200",children:[(0,r.jsxs)("div",{className:"px-6 py-4 bg-white flex flex-col gap-2 shadow-sm z-10",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-[18pt] font-bold text-left",children:w?"Create New Player":"Select Players"}),!w&&(0,r.jsx)("button",{onClick:i,className:"px-4 py-2 bg-black text-white rounded-full text-[15pt] font-bold hover:bg-gray-800 transition-colors",children:"Close"})]}),!w&&(0,r.jsxs)("div",{className:"relative flex items-stretch gap-2",children:[(0,r.jsxs)("div",{className:"flex-1 relative",children:[(0,r.jsx)("input",{type:"text",placeholder:"Search by ID, Phone (last 4), Name (F-L)",title:"Search players",value:m,onChange:e=>b(e.target.value),className:"w-full text-[15pt] h-[58px] p-4 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:outline-none text-black bg-white shadow-sm transition-all"}),m&&L.length>0&&(0,r.jsx)("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border-2 border-gray-300 rounded-lg shadow-lg max-h-[400px] overflow-y-auto z-50",children:P.slice(0,20).map(e=>{let t=f.includes(e.id),a=n.includes(e.id),s=l.includes(e.id),o=!c&&a&&g&&!s;return(0,r.jsxs)("button",{onClick:()=>{o||R(e.id)},disabled:o,className:"w-full flex items-center gap-4 p-4 border-b border-gray-100 transition-colors text-left ".concat(o?"bg-gray-100 opacity-60 cursor-not-allowed":t?"bg-blue-50 hover:bg-blue-100":"hover:bg-gray-50"),children:[(0,r.jsx)("div",{className:"w-7 h-7 shrink-0 rounded flex items-center justify-center border-2 ".concat(o?"bg-gray-200 border-gray-300":t?"bg-blue-600 border-blue-600":"bg-white border-gray-300"),children:t&&(0,r.jsx)("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})})}),(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-[16pt] font-bold ".concat(o?"text-gray-400":t?"text-blue-800":"text-gray-700"),children:e.name}),e.player_id&&(0,r.jsxs)("span",{className:"text-[14pt] font-semibold ".concat(o?"text-gray-400":"text-gray-600"),children:["(",e.player_id,")"]}),a&&(0,r.jsx)("span",{className:"px-2 py-0.5 rounded text-[10pt] font-black uppercase tracking-wider ".concat(o?"bg-gray-100 text-gray-500 border border-gray-200":"bg-green-100 text-green-700 border border-green-200"),children:o?"Claimed":"In Round"}),e.id===p&&(0,r.jsx)("span",{className:"px-2 py-0.5 rounded text-[10pt] font-black uppercase tracking-wider bg-blue-100 text-blue-700 border border-blue-200",children:"YOU"}),(()=>{let t=M(e);return null!==t&&(0,r.jsxs)("span",{className:"text-[14pt] font-semibold ".concat(o?"text-gray-400":"text-gray-600"),children:["(",t,")"]})})()]})})]},e.id)})})]}),(0,r.jsx)("button",{onClick:()=>j(!0),className:"bg-green-600 text-white font-black px-6 rounded-xl text-[14pt] shrink-0 hover:bg-green-700 transition-all shadow-md active:scale-95 h-[58px] flex items-center justify-center",children:"+ New"})]})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-6 bg-slate-50",children:w?(0,r.jsxs)("div",{className:"max-w-lg mx-auto bg-white p-6 rounded-xl shadow-sm border border-gray-200 space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"First Name"}),(0,r.jsx)("input",{type:"text",title:"First Name",className:"w-full border-2 border-gray-300 p-3 rounded-lg text-lg text-black bg-white",value:_.firstName,onChange:e=>E({..._,firstName:e.target.value})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Last Name"}),(0,r.jsx)("input",{type:"text",title:"Last Name",className:"w-full border-2 border-gray-300 p-3 rounded-lg text-lg text-black bg-white",value:_.lastName,onChange:e=>E({..._,lastName:e.target.value})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Email"}),(0,r.jsx)("input",{type:"email",title:"Email Address",className:"w-full border-2 border-gray-300 p-3 rounded-lg text-lg text-black bg-white",value:_.email,onChange:e=>E({..._,email:e.target.value})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Mobile Phone (Use for ID)"}),(0,r.jsx)("input",{type:"tel",title:"Mobile Phone",className:"w-full border-2 border-gray-300 p-3 rounded-lg text-lg text-black bg-white",value:_.phone,onChange:e=>E({..._,phone:e.target.value})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Handicap Index (Optional)"}),(0,r.jsx)("input",{type:"number",step:"0.1",title:"Handicap Index",className:"w-full border-2 border-gray-300 p-3 rounded-lg text-lg text-black bg-white",value:_.handicapIndex,onChange:e=>E({..._,handicapIndex:e.target.value}),placeholder:"0.0"})]}),S&&(0,r.jsx)("div",{className:"text-red-600 font-bold bg-red-50 p-3 rounded-lg text-center",children:S}),(0,r.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,r.jsx)("button",{onClick:()=>{j(!1),C("")},className:"flex-1 bg-gray-200 text-gray-800 font-bold py-3 rounded-lg text-xl",disabled:N,children:"Cancel"}),(0,r.jsx)("button",{onClick:I,disabled:N,className:"flex-1 bg-black text-white font-bold py-3 rounded-lg text-xl disabled:opacity-50",children:N?"Creating...":"Create Player"})]})]}):(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[0===P.length&&(0,r.jsxs)("div",{className:"col-span-full text-center py-10 text-gray-500",children:[(0,r.jsx)("div",{className:"text-[20pt] mb-2",children:"No players found"}),(0,r.jsx)("div",{children:"Try a different search or create a new player."}),(0,r.jsx)("button",{onClick:()=>j(!0),className:"mt-6 bg-green-600 text-white font-bold px-6 py-3 rounded-full text-lg shadow-md",children:"Create New Player"})]}),P.map(e=>{let t=f.includes(e.id),a=n.includes(e.id),s=l.includes(e.id),o=!c&&a&&g&&!s;return(0,r.jsxs)("button",{onClick:()=>R(e.id),disabled:o,className:"flex items-center gap-4 p-4 rounded-xl border-2 transition-all text-left ".concat(o?"border-gray-200 bg-gray-100 opacity-60 cursor-not-allowed":t?"border-blue-500 bg-blue-50 shadow-sm cursor-pointer":"border-gray-100 bg-white hover:border-gray-200 cursor-pointer"),children:[(0,r.jsx)("div",{className:"w-7 h-7 shrink-0 rounded flex items-center justify-center border-2 transition-colors ".concat(o?"bg-gray-200 border-gray-300":t?"bg-blue-600 border-blue-600":"bg-white border-gray-300"),children:t&&(0,r.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-[18pt] font-bold ".concat(o?"text-gray-400":t?"text-blue-800":"text-gray-700"),children:e.name}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[a&&(0,r.jsx)("span",{className:"px-2 py-0.5 rounded text-[10pt] font-bold uppercase tracking-wider ".concat(o?"bg-gray-200 text-gray-400":"bg-green-100 text-green-700"),children:o?"Claimed":"In My Group"}),(()=>{let t=M(e);return null!==t&&(0,r.jsxs)("span",{className:"text-[14pt] font-semibold ".concat(o?"text-gray-400":"text-gray-600"),children:["(",t,")"]})})(),e.preferred_tee_box&&(0,r.jsx)("span",{className:"px-2 py-0.5 rounded text-[12pt] font-bold ".concat(o?"bg-gray-200 text-gray-400":e.preferred_tee_box.toLowerCase().includes("white")?"bg-white text-black border border-black":e.preferred_tee_box.toLowerCase().includes("gold")?"bg-yellow-400 text-black":"bg-gray-300 text-gray-700"),children:e.preferred_tee_box.toLowerCase().includes("white")?"W":e.preferred_tee_box.toLowerCase().includes("gold")?"G":e.preferred_tee_box.charAt(0).toUpperCase()})]})]}),o&&(0,r.jsx)("div",{className:"text-[11pt] text-gray-500 italic mt-0.5",children:"Scored by another device."})]})]},e.id)})]})}),!w&&(0,r.jsxs)("div",{className:"px-4 py-5 bg-gray-50 border-t border-gray-100 flex justify-end gap-3 z-10",children:[(0,r.jsx)("button",{onClick:i,className:"px-4 py-2 rounded-full text-[15pt] font-bold text-gray-600 hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,r.jsxs)("button",{onClick:()=>{s(f),i()},className:"bg-black text-white px-4 py-2 rounded-full text-[15pt] font-bold shadow-lg transition-all active:scale-95",children:["Save (",f.length,")"]})]})]})})}let g=(0,x.createServerReference)("400e89222081663f9862611ade692d927c3f98cb82",x.callServer,void 0,x.findSourceMapURL,"updateLiveRound"),f=(0,x.createServerReference)("4016392dec2572395a2778fdc23e0642bc0f58bbe6",x.callServer,void 0,x.findSourceMapURL,"createLiveRound"),h=(0,x.createServerReference)("40f07dc4568ad5deba38798d20db8aed003a3c9dfa",x.callServer,void 0,x.findSourceMapURL,"addPlayerToLiveRound");function m(e){var t;let{isOpen:l,onClose:s,courseId:o,existingRound:i,allCourses:d=[],showAlert:c,defaultTeeBoxId:x,currentUserId:u}=e,p=(0,n.useRouter)(),m=new Date,b=m.getTimezoneOffset(),v=new Date(m.getTime()-6e4*b).toISOString().split("T")[0],[y,w]=(0,a.useState)(""),[j,N]=(0,a.useState)(v),[k,S]=(0,a.useState)(68),[C,_]=(0,a.useState)(63.8),[E,R]=(0,a.useState)(100),[I,L]=(0,a.useState)(""),[P,M]=(0,a.useState)(""),[F,D]=(0,a.useState)(!1);if((0,a.useEffect)(()=>{if(l){if(i){w(i.name),N(i.date),S(i.par),_(i.rating),R(i.slope),L(i.courseId||"");let e=d.find(e=>e.id===i.courseId);if(e){let t=e.teeBoxes.find(e=>.1>Math.abs(e.rating-i.rating)&&e.slope===i.slope);t&&M(t.id)}}else{let t=d.find(e=>e.name.toLowerCase().includes("city park north"))||d.find(e=>e.id===o)||d[0];if(t){var e;L(t.id),w(t.name),N(v);let l=t.teeBoxes.find(e=>e.name.toLowerCase().includes("white")),r=(x?t.teeBoxes.find(e=>e.id===x):null)||l||t.teeBoxes[0];r&&(M(r.id),_(r.rating),R(r.slope)),(null===(e=t.holes)||void 0===e?void 0:e.length)?S(t.holes.reduce((e,t)=>e+t.par,0)):S(68)}}}},[l,v,o,d,i,x]),!l)return null;let z=async()=>{let e=isNaN(k)?(null==i?void 0:i.par)||68:k,t=isNaN(C)?(null==i?void 0:i.rating)||63.8:C,l=isNaN(E)?(null==i?void 0:i.slope)||100:E;D(!0);try{if(i){let r=await g({id:i.id,name:y||"Live Round",date:j||v,courseId:I||o,par:e,rating:t,slope:l});r.success?(s(),p.push("/live?roundId=".concat(i.id),{scroll:!1}),p.refresh()):(c("Error","Save Failed: "+r.error),D(!1))}else{var r,a,n,m;let i=I||o;if(!i){c("Error","No Course ID selected."),D(!1);return}let g=await f({name:y||"Live Round",date:j||v,courseId:i,courseName:(null===(r=d.find(e=>e.id===i))||void 0===r?void 0:r.name)||"Unknown Course",par:e,rating:t,slope:l});if(g.success&&g.liveRoundId){if(u){P||I&&(null===(n=d.find(e=>e.id===(I||o)))||void 0===n||null===(a=n.teeBoxes.find(e=>e.id===P))||void 0===a||a.id);let e=P;if(!e){let t=d.find(e=>e.id===(I||o)),l=null==t?void 0:t.teeBoxes.find(e=>e.name.toLowerCase().includes("white")),r=x?null==t?void 0:t.teeBoxes.find(e=>e.id===x):null;e=(null==r?void 0:r.id)||(null==l?void 0:l.id)||(null==t?void 0:null===(m=t.teeBoxes[0])||void 0===m?void 0:m.id)}if(e){await h({liveRoundId:g.liveRoundId,playerId:u,teeBoxId:e});let t=localStorage.getItem("live_scoring_my_group_".concat(g.liveRoundId)),l=t?JSON.parse(t):[];l.includes(u)||(l.push(u),localStorage.setItem("live_scoring_my_group_".concat(g.liveRoundId),JSON.stringify(l)))}}s(),p.push("/live?roundId=".concat(g.liveRoundId),{scroll:!1}),p.refresh()}else c("Error","Creation Failed: "+(g.error||"Server Error")),D(!1)}}catch(e){console.error("CRASH:",e),c("Error","A critical error occurred. Please refresh."),D(!1)}};return(0,r.jsx)("div",{className:"fixed inset-0 z-[200] flex items-center justify-center bg-black/60 backdrop-blur-sm px-4",children:(0,r.jsxs)("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200",children:[(0,r.jsxs)("div",{className:"px-6 py-4 bg-black text-white flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-[18pt] font-bold text-left ml-3",children:i?"Edit Live Round":"New Live Round"}),(0,r.jsx)("button",{onClick:s,className:"hover:opacity-70 transition-opacity bg-white text-black text-[15pt] font-bold px-4 py-2 rounded-full",children:"Close"})]}),(0,r.jsxs)("div",{className:"p-6 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-[12pt] font-bold text-gray-700 mb-1",children:"Date"}),(0,r.jsx)("input",{type:"date",value:j,onChange:e=>N(e.target.value),disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg text-[14pt] outline-none text-black bg-gray-100 cursor-not-allowed"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-[12pt] font-bold text-gray-700 mb-1",children:"Course"}),(0,r.jsxs)("select",{value:I,onChange:e=>{let t=e.target.value;L(t),M("");let l=d.find(e=>e.id===t);if(l){var r;w(l.name);let e=l.teeBoxes.find(e=>e.name.toLowerCase().includes("white"))||l.teeBoxes[0];e&&(M(e.id),_(e.rating),R(e.slope)),(null===(r=l.holes)||void 0===r?void 0:r.length)&&S(l.holes.reduce((e,t)=>e+t.par,0))}},className:"w-full px-4 py-2 border border-gray-300 rounded-lg text-[14pt] focus:ring-2 focus:ring-black outline-none text-black bg-white",children:[(0,r.jsx)("option",{value:"",disabled:!0,children:"-- Select Course --"}),null==d?void 0:d.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-[12pt] font-bold text-gray-700 mb-1",children:"Select Tee Box (Auto-fill)"}),(0,r.jsxs)("select",{value:P,onChange:e=>{let t=e.target.value;M(t);let l=d.find(e=>e.id===I);if(l){let e=l.teeBoxes.find(e=>e.id===t);e&&(_(e.rating),R(e.slope),S(l.holes.reduce((e,t)=>e+t.par,0)||k))}},className:"w-full px-4 py-2 border border-gray-300 rounded-lg text-[14pt] focus:ring-2 focus:ring-black outline-none text-black bg-white",children:[(0,r.jsx)("option",{value:"",disabled:!0,children:"-- Select Tee Box --"}),null===(t=d.find(e=>e.id===I))||void 0===t?void 0:t.teeBoxes.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," (R: ",e.rating," / S: ",e.slope,")"]},e.id))]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-[12pt] font-bold text-gray-700 mb-1",children:"Par"}),(0,r.jsx)("input",{type:"number",value:k,onChange:e=>S(parseInt(e.target.value)),className:"w-full px-4 py-2 border border-gray-300 rounded-lg text-[14pt] focus:ring-2 focus:ring-black outline-none text-black bg-white"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-[12pt] font-bold text-gray-700 mb-1",children:"Rating"}),(0,r.jsx)("input",{type:"number",step:"0.1",value:C,onChange:e=>_(parseFloat(e.target.value)),className:"w-full px-4 py-2 border border-gray-300 rounded-lg text-[14pt] focus:ring-2 focus:ring-black outline-none text-black bg-white"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-[12pt] font-bold text-gray-700 mb-1",children:"Slope"}),(0,r.jsx)("input",{type:"number",value:E,onChange:e=>R(parseInt(e.target.value)),className:"w-full px-4 py-2 border border-gray-300 rounded-lg text-[14pt] focus:ring-2 focus:ring-black outline-none text-black bg-white"})]})]})]}),(0,r.jsxs)("div",{className:"px-6 py-4 bg-gray-50 flex justify-end gap-3 mt-2",children:[(0,r.jsx)("button",{onClick:s,disabled:F,className:"px-4 py-2 rounded-full text-[15pt] font-bold text-gray-600 hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,r.jsx)("button",{onClick:z,disabled:F,className:"bg-black text-white px-4 py-2 rounded-full text-[15pt] font-bold shadow-lg hover:bg-gray-800 disabled:opacity-50 flex items-center gap-2 cursor-pointer",children:F?"Saving...":"Save Round"})]})]})})}function b(e){let{isOpen:t,title:l,message:a,confirmText:n="Confirm",cancelText:s="Cancel",onConfirm:o,onCancel:i,isDestructive:d=!1,hideCancel:c=!1}=e;return t?(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[250] p-4 backdrop-blur-sm",children:(0,r.jsx)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden transform transition-all scale-100",children:(0,r.jsxs)("div",{className:"p-6 text-center",children:[(0,r.jsx)("h3",{className:"text-xl font-black text-gray-900 mb-2",children:l}),(0,r.jsx)("p",{className:"text-[14pt] text-gray-600 mb-8 leading-relaxed",children:a}),(0,r.jsxs)("div",{className:"flex gap-3 justify-center",children:[!c&&(0,r.jsx)("button",{onClick:i,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 text-[14pt] font-bold rounded-xl hover:bg-gray-200 transition-colors active:scale-95",children:s}),(0,r.jsx)("button",{onClick:o,className:"flex-1 px-4 py-3 text-white text-[14pt] font-bold rounded-xl transition-colors shadow-lg active:scale-95 ".concat(d?"bg-red-600 hover:bg-red-700":"bg-black hover:bg-gray-800"),children:n})]})]})})}):null}function v(e){let{isOpen:t,onClose:l,onAdd:n,onUpdate:s,onDelete:o,roundData:i,editingGuest:d}=e,[c,x]=(0,a.useState)(""),[u,p]=(0,a.useState)(""),[g,f]=(0,a.useState)(""),[h,m]=(0,a.useState)(!1),[v,y]=(0,a.useState)(null);return((0,a.useEffect)(()=>{d?(x(d.name),p(d.index.toString()),f(d.courseHandicap.toString())):(x(""),p(""),f("")),m(!1)},[d,t]),(0,a.useEffect)(()=>{if(i&&u&&!d&&!h){let e=parseFloat(u);if(isNaN(e))return;let{rating:t,slope:l,par:r}=i;f(Math.round(e*l/113+(t-r)).toString())}},[u,i,d,h]),t)?(0,r.jsxs)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:[(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:d?"Edit Guest Player":"Add Guest Player"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Name"}),(0,r.jsx)("input",{type:"text",value:c,onChange:e=>x(e.target.value),className:"w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none text-lg text-black bg-white",placeholder:"Guest Name"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Handicap Index"}),(0,r.jsx)("input",{type:"number",step:"0.1",value:u,onChange:e=>p(e.target.value),className:"w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none text-lg text-black bg-white [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0.0"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Course Handicap ",i&&!d&&!h&&(0,r.jsx)("span",{className:"text-xs text-gray-500",children:"(Auto-calculated)"})]}),(0,r.jsx)("input",{type:"number",value:g,onChange:e=>{f(e.target.value),m(!0)},className:"w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none text-lg text-black bg-white [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0"}),i&&!d&&(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Based on Rating: ",i.rating,", Slope: ",i.slope,", Par: ",i.par]})]})]}),(0,r.jsxs)("div",{className:"flex gap-3 mt-6",children:[d&&(0,r.jsx)("button",{onClick:()=>{if("cpgc-Delete"!==prompt("Enter password to delete:")){alert("Incorrect password.");return}y({isOpen:!0,title:"Delete Guest Player",message:"Are you sure you want to delete this guest player?",isDestructive:!0,onConfirm:()=>{y(null),o&&d&&o(d.id)}})},className:"px-4 py-2 bg-red-600 text-white rounded-lg font-bold hover:bg-red-700 transition-all text-[15pt]",children:"Delete"}),(0,r.jsx)("button",{onClick:l,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg font-bold hover:bg-gray-300 transition-all text-[15pt]",children:"Cancel"}),(0,r.jsx)("button",{onClick:()=>{if(!c.trim()){alert("Please enter a name");return}let e={name:c.trim(),index:parseFloat(u)||0,courseHandicap:parseInt(g)||0};d&&s?s(d.id,e):n(e),x(""),p(""),f(""),l()},className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg font-bold hover:bg-blue-700 transition-all text-[15pt]",children:d?"Update Guest":"Add Guest"})]})]}),v&&(0,r.jsx)(b,{isOpen:v.isOpen,title:v.title,message:v.message,isDestructive:v.isDestructive,onConfirm:v.onConfirm,onCancel:()=>y(null)})]}):null}function y(e){let{isOpen:t,onClose:l,players:n,liveRoundId:s,onSave:o}=e,[i,d]=(0,a.useState)(new Set),[c,x]=(0,a.useState)(!1);if(!t)return null;let u=n.filter(e=>!e.isGuest),p=e=>{let t=new Set(i);t.has(e)?t.delete(e):t.add(e),d(t)},g=async()=>{if(0===i.size){alert("Please select at least one player");return}x(!0);try{let e=Array.from(i).map(e=>{let t=u.find(t=>t.id===e);return(null==t?void 0:t.liveRoundPlayerId)||e});await o(e),d(new Set),l()}catch(e){console.error("Failed to save:",e)}finally{x(!1)}},f=e=>{let t=e.trim().split(" ");if(1===t.length)return{first:t[0],last:""};let l=t[t.length-1];return{first:t.slice(0,-1).join(" "),last:l}};return(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 p-4 rounded-t-xl",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-[18pt] font-bold text-white text-left ml-3",children:"Add to Club Scores"}),(0,r.jsx)("button",{onClick:l,className:"bg-white/20 hover:bg-white/30 text-white rounded-lg px-4 py-2 transition-colors font-bold text-[15pt]",children:"Close"})]}),(0,r.jsx)("p",{className:"text-white/90 text-[12pt] mt-1",children:"Select players to copy their scores to the main club scores page"})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:0===u.length?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,r.jsx)("p",{className:"text-[14pt]",children:"No eligible players found"}),(0,r.jsx)("p",{className:"text-[12pt] mt-2",children:"Guest players cannot be added to club scores"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mb-4 pb-3 border-b-2 border-gray-200",children:(0,r.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer hover:bg-gray-50 p-3 rounded-lg transition-colors",children:[(0,r.jsx)("input",{type:"checkbox",checked:i.size===u.length,onChange:()=>{0!==u.length&&(i.size===u.length&&u.length>0?d(new Set):d(new Set(u.map(e=>e.id))))},className:"w-6 h-6 rounded border-2 border-gray-300 text-blue-600 focus:ring-2 focus:ring-blue-500"}),(0,r.jsxs)("span",{className:"font-bold text-[16pt] text-gray-900",children:["Select All (",u.length,")"]})]})}),(0,r.jsx)("div",{className:"space-y-2",children:u.map(e=>{let{first:t,last:l}=f(e.name),a=i.has(e.id);return(0,r.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer p-3 rounded-lg transition-all ".concat(a?"bg-blue-50 border-2 border-blue-500":"bg-gray-50 border-2 border-transparent hover:bg-gray-100"),children:[(0,r.jsx)("input",{type:"checkbox",checked:a,onChange:()=>p(e.id),className:"w-6 h-6 rounded border-2 border-gray-300 text-blue-600 focus:ring-2 focus:ring-blue-500"}),(0,r.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"font-bold text-[16pt] text-gray-900",children:[t," ",(0,r.jsx)("span",{className:"font-normal",children:l})]}),(0,r.jsxs)("div",{className:"text-[12pt] text-gray-600",children:["Thru: ",e.thru," holes"]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"text-[14pt] font-bold text-gray-900",children:["Gross: ",e.totalGross||"-"]}),(0,r.jsxs)("div",{className:"text-[12pt] text-gray-600",children:["Net: ",e.totalNet||"-"]})]})]})]},e.id)})})]})}),(0,r.jsx)("div",{className:"border-t-2 border-gray-200 p-4 bg-gray-50 rounded-b-xl",children:(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("button",{onClick:l,className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-900 font-bold px-4 py-2 rounded-full text-[15pt] transition-colors",children:"Cancel"}),(0,r.jsx)("button",{onClick:g,disabled:0===i.size||c,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold px-4 py-2 rounded-full text-[15pt] transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:c?"Saving...":"Save to Club (".concat(i.size,")")})]})})]})})}var w=l(689),j=l(9253);function N(e){var t;let{data:l,isOpen:a,onClose:n}=e;if(!a)return null;let{player:s,round:o,teeBox:i,scores:d}=l,c=o.course,x=new Map;d.forEach(e=>x.set(e.hole.holeNumber,e.strokes));let u=c.holes.filter(e=>e.holeNumber<=9),p=c.holes.filter(e=>e.holeNumber>9),g=(e,t)=>e.reduce((e,l)=>"par"===t?e+l.par:e+(x.get(l.holeNumber)||0),0),f=g(u,"par"),h=g(u,"score"),m=g(p,"par"),b=g(p,"score"),v=h+b,y=(null==i?void 0:i.slope)||113,w=c.holes.reduce((e,t)=>e+t.par,0),N=(null==i?void 0:i.rating)||w,k=Math.round(y/113*(null!==(t=l.player.handicapIndex)&&void 0!==t?t:0)+(N-w)),S=(v||0)-k,C=(e,t)=>{if(!t)return"bg-transparent";let l=t-e;return l<=-2?"bg-yellow-300":-1===l?"bg-green-300":0===l?"bg-white text-black":1===l?"bg-orange-200":"bg-red-300"},_=e=>{let{title:t,holes:l,totalLabel:a,totalPar:n,totalScore:s}=e;return(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h4",{className:"font-bold text-black mb-2 px-1 text-[14pt]",children:t}),(0,r.jsxs)("div",{className:"flex bg-white rounded-lg overflow-hidden border border-gray-100 shadow-sm",children:[(0,r.jsx)("div",{className:"flex-1 overflow-x-auto no-scrollbar",children:(0,r.jsx)("table",{className:"w-full text-center border-collapse min-w-[300px]",children:(0,r.jsxs)("tbody",{children:[(0,r.jsx)("tr",{className:"border-b border-gray-100",children:l.map(e=>(0,r.jsx)("td",{className:"px-1 py-2 w-10 font-bold text-[14pt] text-black",children:e.holeNumber},e.id))}),(0,r.jsx)("tr",{className:"border-b border-gray-100",children:l.map(e=>(0,r.jsx)("td",{className:"px-1 py-2 w-10 text-[14pt] text-gray-500",children:e.par},e.id))}),(0,r.jsx)("tr",{className:"border-b border-gray-100",children:l.map(e=>{let t=x.get(e.holeNumber);return(0,r.jsx)("td",{className:"px-1 py-2 w-10 font-black text-[14pt] ".concat(C(e.par,t)),children:t||"-"},e.id)})}),(0,r.jsx)("tr",{children:l.map(e=>(0,r.jsx)("td",{className:"px-1 py-2 w-10 text-[14pt] text-gray-400",children:e.difficulty||"-"},e.id))})]})})}),(0,r.jsx)("div",{className:"w-16 bg-gray-100 border-l border-gray-200 shrink-0",children:(0,r.jsx)("table",{className:"w-full text-center border-collapse",children:(0,r.jsxs)("tbody",{children:[(0,r.jsx)("tr",{className:"border-b border-gray-100",children:(0,r.jsx)("td",{className:"px-1 py-2 text-[14pt] font-bold text-transparent",children:"\xa0"})}),(0,r.jsx)("tr",{className:"border-b border-gray-100",children:(0,r.jsx)("td",{className:"px-1 py-2 text-[14pt] font-bold text-gray-500",children:n})}),(0,r.jsx)("tr",{className:"border-b border-gray-100",children:(0,r.jsx)("td",{className:"px-1 py-2 text-[14pt] font-black text-black",children:s||"-"})}),(0,r.jsx)("tr",{children:(0,r.jsx)("td",{className:"px-1 py-2 text-[14pt] text-transparent",children:"\xa0"})})]})})})]})]})};return(0,r.jsx)("div",{className:"fixed inset-0 z-[200] flex items-center justify-center bg-black/80 backdrop-blur-md animate-in fade-in duration-200",children:(0,r.jsxs)("div",{className:"bg-slate-50 w-full h-full flex flex-col overflow-hidden animate-in zoom-in-95 duration-200",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-3 bg-white border-b border-gray-100",children:[(0,r.jsx)("span",{className:"text-[14pt] font-bold text-gray-400 uppercase tracking-widest",children:"Scorecard"}),(0,r.jsx)("button",{onClick:n,className:"px-4 py-2 bg-black text-white rounded-full text-[15pt] font-bold hover:bg-gray-800 transition-colors mr-3",children:"Close"})]}),(0,r.jsxs)("div",{className:"overflow-y-auto px-1 pb-8 bg-slate-50",children:[(0,r.jsxs)("div",{className:"text-center mb-8 px-1",children:[(0,r.jsx)("h2",{className:"text-[14pt] font-black text-black tracking-tight flex items-center justify-center gap-2",children:s.name}),(0,r.jsxs)("div",{className:"flex justify-center items-center gap-3 mt-2 text-[14pt] text-gray-500 font-medium whitespace-nowrap overflow-x-auto no-scrollbar",children:[(0,r.jsx)("span",{children:(0,j.GP)(new Date(o.date),"MMMM d, yyyy")}),(0,r.jsx)("span",{className:"w-1 h-1 rounded-full bg-gray-300"}),(0,r.jsx)("span",{children:c.name})]}),(0,r.jsxs)("div",{className:"flex justify-center items-center gap-3 mt-1 text-[14pt] text-gray-600 font-medium whitespace-nowrap overflow-x-auto no-scrollbar",children:[(0,r.jsx)("span",{className:"text-blue-600",children:null==i?void 0:i.name}),(0,r.jsx)("span",{className:"w-1 h-1 rounded-full bg-gray-300"}),(0,r.jsxs)("span",{children:["Par ",f+m]}),(0,r.jsx)("span",{className:"w-1 h-1 rounded-full bg-gray-300"}),(0,r.jsxs)("span",{children:["Rating ",null==i?void 0:i.rating.toFixed(1)]}),(0,r.jsx)("span",{className:"w-1 h-1 rounded-full bg-gray-300"}),(0,r.jsxs)("span",{children:["Slope ",null==i?void 0:i.slope]})]})]}),(0,r.jsx)(_,{title:"Front 9",holes:u,totalLabel:"OUT",totalPar:f,totalScore:h}),(0,r.jsx)(_,{title:"Back 9",holes:p,totalLabel:"IN",totalPar:m,totalScore:b}),(0,r.jsxs)("div",{className:"flex flex-wrap justify-center gap-3 mt-8",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)("span",{className:"w-3 h-3 bg-yellow-300 rounded-sm"}),(0,r.jsx)("span",{className:"text-[14pt] font-bold text-gray-500 uppercase",children:"Eagle (-2)"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)("span",{className:"w-3 h-3 bg-green-300 rounded-sm"}),(0,r.jsx)("span",{className:"text-[14pt] font-bold text-gray-500 uppercase",children:"Birdie (-1)"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)("span",{className:"w-3 h-3 bg-white border border-gray-300 rounded-sm"}),(0,r.jsx)("span",{className:"text-[14pt] font-bold text-gray-500 uppercase",children:"Par (E)"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)("span",{className:"w-3 h-3 bg-orange-200 rounded-sm"}),(0,r.jsx)("span",{className:"text-[14pt] font-bold text-gray-500 uppercase",children:"Bogey (+1)"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)("span",{className:"w-3 h-3 bg-red-300 rounded-sm"}),(0,r.jsx)("span",{className:"text-[14pt] font-bold text-gray-500 uppercase",children:"Double+ (+2)"})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 mt-8 flex justify-around items-center text-center",children:[(0,r.jsxs)("div",{className:"text-left",children:[(0,r.jsx)("span",{className:"text-[14pt] font-bold text-gray-400 uppercase tracking-wider block mb-1",children:"GRS"}),(0,r.jsx)("span",{className:"text-[14pt] font-black text-black",children:h>0||b>0?(0,r.jsxs)(r.Fragment,{children:[h," + ",b," = ",v]}):(0,r.jsx)(r.Fragment,{children:v||"-"})})]}),(0,r.jsx)("div",{className:"w-px h-10 bg-gray-100 mx-1"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-[14pt] font-bold text-gray-400 uppercase tracking-wider block mb-1",children:"HCP"}),(0,r.jsx)("span",{className:"text-[14pt] font-black text-black",children:k})]}),(0,r.jsx)("div",{className:"w-px h-10 bg-gray-100 mx-1"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-[14pt] font-bold text-gray-400 uppercase tracking-wider block mb-1",children:"NET"}),(0,r.jsx)("span",{className:"text-[14pt] font-black text-black",children:S||"-"})]})]})]})]})})}let k=(0,x.createServerReference)("40009ab4d750cb699b4e9b5e6b95e437c8cb7014de",x.callServer,void 0,x.findSourceMapURL,"getScorecardDetails"),S=(0,x.createServerReference)("60e722b8157152e37aaec2f21d2f11b8c1e362c168",x.callServer,void 0,x.findSourceMapURL,"saveRoundWinnings");function C(e){let{roundId:t,payouts:l}=e,[n,o]=(0,a.useState)(!1),[i,d]=(0,a.useState)(!1),[c,x]=(0,a.useState)(null);return((0,a.useEffect)(()=>{let e=()=>{d("true"===s.A.get("admin_session"))};return e(),window.addEventListener("admin-change",e),()=>window.removeEventListener("admin-change",e)},[]),i)?(0,r.jsxs)("div",{className:"pt-4",children:[(0,r.jsx)("button",{onClick:()=>{x({isOpen:!0,title:"Save Winnings",message:"This will save these calculated winnings to the database. Continue?",isDestructive:!1,onConfirm:async()=>{x(null),o(!0);try{await S(t,l),alert("Winnings saved successfully!")}catch(e){console.error(e),alert("Failed to save winnings.")}finally{o(!1)}}})},disabled:n,className:"w-full bg-[#059669] hover:bg-[#047857] text-white font-bold px-1 py-2 rounded-full shadow-sm transition-colors text-[14pt] uppercase tracking-wider flex items-center justify-center gap-2 h-auto cursor-pointer disabled:opacity-50",children:n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin h-6 w-6 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Pool"}),c&&(0,r.jsx)(b,{isOpen:c.isOpen,title:c.title,message:c.message,isDestructive:c.isDestructive,onConfirm:c.onConfirm,onCancel:()=>x(null)})]}):null}let _=e=>{let{className:t}=e;return(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,r.jsx)("path",{d:"M12 2v4"}),(0,r.jsx)("path",{d:"m16.2 7.8 2.9-2.9"}),(0,r.jsx)("path",{d:"M18 12h4"}),(0,r.jsx)("path",{d:"m16.2 16.2 2.9 2.9"}),(0,r.jsx)("path",{d:"M12 18v4"}),(0,r.jsx)("path",{d:"m4.9 19.1 2.9-2.9"}),(0,r.jsx)("path",{d:"M2 12h4"}),(0,r.jsx)("path",{d:"m4.9 4.9 2.9 2.9"})]})};function E(e){let{allPoolParticipants:t,poolActivePlayers:l,round:n,flights:s,processedFlights:o,winningsMap:i}=e,[d,c]=(0,a.useState)(null),[x,u]=(0,a.useState)(null),p=async e=>{let t=n.players.find(t=>t.player.id===e);if(!t||x)return;u(t.id);let l=await k(t.id);u(null),l.data?c(l.data):alert("Could not load scorecard details.")};return(0,r.jsxs)("div",{className:"p-6 space-y-8",children:[0===t.length?(0,r.jsx)("div",{className:"text-center",children:"No Participants selected."}):0===l.length?(0,r.jsxs)("div",{className:"py-20 flex flex-col items-center justify-center text-center space-y-6",children:[(0,r.jsx)("div",{className:"bg-amber-50 rounded-full p-8 text-amber-500",children:(0,r.jsx)("svg",{className:"w-16 h-16",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"text-[14pt] font-black text-gray-900 tracking-tight",children:"Waiting for Scores"}),(0,r.jsxs)("p",{className:"text-[14pt] text-gray-500 max-w-md mx-auto",children:[t.length," players are set for the pool, but they haven't posted scores for this round yet."]})]})]}):(0,r.jsxs)(r.Fragment,{children:[o.map((e,t)=>(0,r.jsxs)("div",{className:"space-y-12",children:[s.length>1&&(0,r.jsx)("div",{className:"border-b-2 border-gray-900 pb-2",children:(0,r.jsx)("h2",{className:"text-[14pt] font-black text-gray-900 uppercase tracking-tighter",children:e.name})}),(0,r.jsxs)("div",{className:"relative grid grid-cols-1 md:grid-cols-2 gap-12",children:[(0,r.jsx)("div",{className:"hidden md:block absolute left-1/2 top-0 bottom-0 w-px bg-gray-200 -ml-[0.5px]"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"text-center pb-2 border-b border-gray-900 mb-4",children:[(0,r.jsx)("h3",{className:"text-[14pt] font-black text-gray-900 uppercase tracking-widest",children:"Front Nine"}),(0,r.jsxs)("div",{className:"text-[14pt] font-black text-green-600 mt-0.5",children:["$",e.pots.front.toFixed(2)]})]}),(0,r.jsx)("div",{className:"space-y-3",children:e.frontWinners.map((e,t)=>(0,r.jsxs)("div",{className:"flex justify-between items-center group",children:[(0,r.jsxs)("div",{className:"flex gap-3 items-center flex-1",children:[(0,r.jsxs)("button",{onClick:()=>p(e.id),className:"flex flex-col text-left cursor-pointer",children:[(0,r.jsx)("span",{className:"text-[14pt] font-black text-blue-600 underline decoration-black decoration-2 leading-tight",children:e.name.split(" ")[0]}),(0,r.jsx)("span",{className:"text-[14pt] text-gray-600 leading-none",children:e.name.split(" ").slice(1).join(" ")})]}),x===e.id&&(0,r.jsx)(_,{className:"w-4 h-4 animate-spin text-gray-400"})]}),(0,r.jsxs)("div",{className:"text-right flex items-center gap-0 w-[200px] justify-end",children:[(0,r.jsx)("span",{className:"text-[14pt] text-gray-800 font-medium w-[30px] text-center",title:"Gross",children:e.gross}),(0,r.jsx)("span",{className:"text-[14pt] text-gray-400 font-medium w-[30px] text-center",title:"Half Hcp",children:e.frontHcp}),(0,r.jsxs)("span",{className:"text-[14pt] font-black text-black w-[50px] text-center",title:"Net",children:["(",e.score.toFixed(0),")"]}),(0,r.jsxs)("span",{className:"text-[14pt] font-black text-green-600 w-[70px] text-right",children:["$",e.amount.toFixed(2)]})]})]},t))})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"text-center pb-2 border-b border-gray-900 mb-4",children:[(0,r.jsx)("h3",{className:"text-[14pt] font-black text-gray-900 uppercase tracking-widest",children:"Back Nine"}),(0,r.jsxs)("div",{className:"text-[14pt] font-black text-green-600 mt-0.5",children:["$",e.pots.back.toFixed(2)]})]}),(0,r.jsx)("div",{className:"space-y-3",children:e.backWinners.map((e,t)=>(0,r.jsxs)("div",{className:"flex justify-between items-center group",children:[(0,r.jsxs)("div",{className:"flex gap-3 items-center flex-1",children:[(0,r.jsxs)("button",{onClick:()=>p(e.id),className:"flex flex-col text-left cursor-pointer",children:[(0,r.jsx)("span",{className:"text-[14pt] font-black text-blue-600 underline decoration-black decoration-2 leading-tight",children:e.name.split(" ")[0]}),(0,r.jsx)("span",{className:"text-[14pt] text-gray-600 leading-none",children:e.name.split(" ").slice(1).join(" ")})]}),x===e.id&&(0,r.jsx)(_,{className:"w-4 h-4 animate-spin text-gray-400"})]}),(0,r.jsxs)("div",{className:"text-right flex items-center gap-0 w-[200px] justify-end",children:[(0,r.jsx)("span",{className:"text-[14pt] text-gray-800 font-medium w-[30px] text-center",title:"Gross",children:e.gross}),(0,r.jsx)("span",{className:"text-[14pt] text-gray-400 font-medium w-[30px] text-center",title:"Half Hcp",children:e.backHcp}),(0,r.jsxs)("span",{className:"text-[14pt] font-black text-black w-[50px] text-center",title:"Net",children:["(",e.score.toFixed(0),")"]}),(0,r.jsxs)("span",{className:"text-[14pt] font-black text-green-600 w-[70px] text-right",children:["$",e.amount.toFixed(2)]})]})]},t))})]})]}),(0,r.jsx)("div",{className:"border-t-2 border-dashed border-gray-300 my-8"}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"text-center pb-2 border-b border-gray-900 max-w-sm mx-auto mb-6",children:[(0,r.jsx)("h3",{className:"text-[14pt] font-black text-gray-900 uppercase tracking-widest leading-none",children:"Total"}),(0,r.jsxs)("div",{className:"text-[14pt] font-black text-green-600 mt-1",children:["$",e.pots.total.toFixed(2)]})]}),(0,r.jsx)("div",{className:"space-y-4 max-w-2xl mx-auto",children:e.totalWinners.map((e,t)=>(0,r.jsxs)("div",{className:"flex justify-between items-center group",children:[(0,r.jsxs)("div",{className:"flex gap-4 items-center flex-1",children:[(0,r.jsxs)("button",{onClick:()=>p(e.id),className:"flex flex-col text-left cursor-pointer",children:[(0,r.jsx)("span",{className:"text-[14pt] font-black text-blue-600 underline decoration-black decoration-2 leading-tight",children:e.name.split(" ")[0]}),(0,r.jsx)("span",{className:"text-[14pt] text-gray-600 leading-none",children:e.name.split(" ").slice(1).join(" ")})]}),x===e.id&&(0,r.jsx)(_,{className:"w-4 h-4 animate-spin text-gray-400"})]}),(0,r.jsxs)("div",{className:"text-right flex items-center gap-0 w-[240px] justify-end",children:[(0,r.jsx)("span",{className:"text-[14pt] text-gray-800 font-medium w-[40px] text-center",title:"Gross",children:e.gross}),(0,r.jsx)("span",{className:"text-[14pt] text-gray-400 font-medium w-[40px] text-center",title:"Net",children:e.courseHcp}),(0,r.jsxs)("span",{className:"text-[14pt] font-black text-black w-[60px] text-center",title:"Total",children:["(",e.score.toFixed(0),")"]}),(0,r.jsxs)("span",{className:"text-[14pt] font-black text-green-600 w-[100px] text-right",children:["$",e.amount.toFixed(2)]})]})]},t))})]})]},t)),(0,r.jsxs)("div",{className:"pt-10 space-y-6",children:[(0,r.jsx)("h3",{className:"text-[14pt] font-bold text-gray-900",children:"Total by Winners:"}),(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Array.from(i.entries()).sort((e,t)=>t[1]-e[1]).map(e=>{let[t,l]=e;return(0,r.jsxs)("div",{className:"bg-[#f4fbf7] border border-green-100 rounded-lg p-3 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex flex-col overflow-hidden",children:[(0,r.jsx)("span",{className:"text-[14pt] font-black text-black leading-none",children:t.split(" ")[0]}),(0,r.jsx)("span",{className:"text-[14pt] text-gray-600 truncate",children:t.split(" ").slice(1).join(" ")})]}),(0,r.jsxs)("span",{className:"text-[14pt] font-black text-green-600 ml-2 whitespace-nowrap",children:["$",l.toFixed(2)]})]},t)})})]}),(0,r.jsx)(C,{roundId:n.id,payouts:Array.from(i.entries()).map(e=>{let[t,l]=e,r=n.players.find(e=>e.player.name===t);return{playerId:(null==r?void 0:r.player_id)||"",amount:l}})})]}),d&&(0,r.jsx)(N,{data:d,isOpen:!!d,onClose:()=>c(null)})]})}let R=(0,x.createServerReference)("406fc12390af8bd16819160cbaca215638b8b3cea0",x.callServer,void 0,x.findSourceMapURL,"getPoolResults"),I=(0,x.createServerReference)("60728f089565641ef1bae86aaf5f9593972fbeaf0c",x.callServer,void 0,x.findSourceMapURL,"updatePoolParticipants");function L(e){let{roundId:t,allPlayers:l,initialSelectedIds:n,isOpen:s,onClose:o,isAdmin:i}=e,[d,c]=(0,a.useState)(n),[x,u]=(0,a.useState)(!1);if(!s)return null;let p=e=>{i&&c(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},g=async()=>{u(!0);try{await I(t,d),o(),window.location.reload()}catch(e){console.error(e),alert("Failed to update players: ".concat(e.message||"Unknown error"))}finally{u(!1)}},f=[...l].sort((e,t)=>e.name.localeCompare(t.name));return(0,r.jsx)("div",{className:"fixed inset-0 z-[200] flex items-center justify-center bg-black/60 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"bg-white w-full h-full flex flex-col shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200",children:[(0,r.jsxs)("div",{className:"px-1 py-5 border-b border-gray-100 flex justify-between items-center bg-[#f8fafc]",children:[(0,r.jsx)("h2",{className:"text-[14pt] font-black text-gray-800 tracking-tight",children:"Manage Pool Participants"}),(0,r.jsx)("button",{onClick:o,className:"px-4 py-2 bg-black text-white rounded-full text-[15pt] font-bold hover:bg-gray-800 transition-colors",children:"Close"})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[i&&(0,r.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,r.jsx)("button",{onClick:()=>c(l.map(e=>e.id)),className:"text-[14pt] font-bold text-green-600 hover:text-green-700 transition-colors",children:"Select All"}),(0,r.jsx)("button",{onClick:()=>c([]),className:"text-[14pt] font-bold text-red-600 hover:text-red-700 transition-colors",children:"Uncheck All"})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:f.map(e=>{let t=d.includes(e.id);return(0,r.jsxs)("button",{onClick:()=>p(e.id),disabled:!i,className:"flex items-center gap-4 p-4 rounded-xl border-2 transition-all text-left ".concat(t?"border-green-500 bg-green-50 shadow-sm":"border-gray-100 bg-white hover:border-gray-200"," ").concat(i?"cursor-pointer":"cursor-not-allowed opacity-60"),children:[(0,r.jsx)("div",{className:"w-7 h-7 rounded flex items-center justify-center border-2 transition-colors ".concat(t?"bg-green-600 border-green-600":"bg-white border-gray-300"),children:t&&(0,r.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})})}),(0,r.jsx)("span",{className:"text-[14pt] font-bold ".concat(t?"text-green-800":"text-gray-700"),children:e.name})]},e.id)})})]}),(0,r.jsxs)("div",{className:"px-1 py-5 bg-[#f8fafc] border-t border-gray-100 flex justify-end gap-3",children:[(0,r.jsx)("button",{onClick:o,className:"px-4 py-2 rounded-xl text-[15pt] font-bold text-gray-600 hover:bg-gray-200 transition-colors",disabled:x,children:i?"Cancel":"Close"}),i&&(0,r.jsx)("button",{onClick:g,disabled:x,className:"bg-[#04d361] hover:bg-[#04b754] text-white px-4 py-2 rounded-xl text-[15pt] font-bold shadow-lg transition-all active:scale-95 flex items-center gap-2",children:x?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Pool Participants"})]})]})})}function P(e){let{roundId:t,allPlayers:l,currentParticipantIds:n}=e,[o,i]=(0,a.useState)(!1),[d,c]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let e=()=>{c("true"===s.A.get("admin_session"))};return e(),window.addEventListener("admin-change",e),()=>window.removeEventListener("admin-change",e)},[]),(0,a.useEffect)(()=>{o&&c("true"===s.A.get("admin_session"))},[o]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:()=>i(!0),className:"bg-black text-white px-4 py-2 rounded-full text-[15pt] font-bold hover:bg-gray-800 transition-colors shadow-sm cursor-pointer",children:["Players (",n.length,")"]}),(0,r.jsx)(L,{roundId:t,allPlayers:l,initialSelectedIds:n,isOpen:o,onClose:()=>i(!1),isAdmin:d})]})}function M(e){let{date:t,roundName:l,isTournament:a,flights:n}=e,s=async()=>{let[e,r,s]=t.split("T")[0].split("-").map(Number),o=(0,j.GP)(new Date(e,r-1,s,12,0,0),"MMMM d, yyyy"),i='\n            <div style="font-family: Arial, sans-serif; color: #333; max-width: 650px; background: white; padding: 20px; border: 1px solid #e5e7eb;">\n                <div style="text-align: center; border-bottom: 2px solid #16a34a; padding-bottom: 15px; margin-bottom: 20px;">\n                    <h1 style="margin: 0; font-size: 24px; color: #16a34a;">$5 POOL RESULTS</h1>\n                    <div style="margin-top: 5px; font-size: 18px; color: #4b5563;">\n                        '.concat(o," ").concat(l?" - ".concat(l):"","\n                    </div>\n                    ").concat(a?'<div style="color: #b45309; font-weight: bold; margin-top: 5px;">\uD83C\uDFC6 TOURNAMENT RESULTS</div>':"","\n                </div>\n        ");n.forEach(e=>{var t;let l=(null===(t=e.players)||void 0===t?void 0:t.length)||0,r=5*l;i+='\n                <div style="margin-bottom: 25px;">\n                    <h2 style="background: #f1f5f9; padding: 8px; font-size: 18px; border-left: 4px solid #16a34a; margin-bottom: 15px;">'.concat(e.name," (").concat(l," players, $").concat(r.toFixed(2)," collected)</h2>\n            "),a?i+="<h3>Tournament Placement</h3>":(i+="<h3>Front Nine ($".concat(e.pots.front.toFixed(2),")</h3>"),i+=c(e.frontWinners,"front"),i+='<hr style="border: 0; border-top: 2px dashed #9ca3af; margin: 20px 0;">',i+="<h3>Back Nine ($".concat(e.pots.back.toFixed(2),")</h3>"),i+=c(e.backWinners,"back"),i+='<hr style="border: 0; border-top: 2px dashed #9ca3af; margin: 20px 0;">',i+="<h3>Total ($".concat(e.pots.total.toFixed(2),")</h3>")),i+=c(e.totalWinners,"total"),i+="</div>"}),i+='<hr style="border: 0; border-top: 3px double #16a34a; margin: 20px 0;">';let d=new Map;function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"total";if(0===e.length)return'<p style="color: #9ca3af; font-style: italic;">No entries</p>';let l='\n                <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px; font-size: 14px;">\n                    <thead>\n                        <tr style="border-bottom: 1px solid #e5e7eb; text-align: left; color: #6b7280;">\n                            <th style="padding: 6px 0;">Pos</th>\n                            <th style="padding: 6px 0;">Player</th>\n                            <th style="padding: 6px 0; text-align: center;">Gross</th>\n                            <th style="padding: 6px 0; text-align: center;">Hcp</th>\n                            <th style="padding: 6px 0; text-align: center;">Net</th>\n                            <th style="padding: 6px 0; text-align: right;">Amount</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n            ';return e.forEach((e,r)=>{let a="front"===t?e.frontHcp||0:"back"===t?e.backHcp||0:e.courseHcp||0;l+='\n                    <tr style="border-bottom: 1px solid #f3f4f6;">\n                        <td style="padding: 8px 0;">'.concat(e.position||r+1,'</td>\n                        <td style="padding: 8px 0;"><b>').concat(e.name,'</b></td>\n                        <td style="padding: 8px 0; text-align: center;">').concat(e.gross,'</td>\n                        <td style="padding: 8px 0; text-align: center; color: #9ca3af;">').concat(a,'</td>\n                        <td style="padding: 8px 0; text-align: center; color: #16a34a; font-weight: bold;">(').concat(Math.round(e.score),')</td>\n                        <td style="padding: 8px 0; text-align: right; font-weight: bold;">$').concat(e.amount.toFixed(2),"</td>\n                    </tr>\n                ")}),l+="</tbody></table>"}n.forEach(e=>{[...e.frontWinners,...e.backWinners,...e.totalWinners].forEach(e=>{let t=d.get(e.name)||0;d.set(e.name,t+e.amount)})}),i+='\n            <div style="padding: 20px 0;">\n                <h3 style="margin-top: 0; margin-bottom: 15px; color: #111; font-size: 11pt; font-weight: bold;">Total by Winners:</h3>\n                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">\n        ',Array.from(d.entries()).sort((e,t)=>t[1]-e[1]).forEach(e=>{let[t,l]=e,[r,...a]=t.split(" "),n=a.join(" ");i+='\n                    <div style="background: #f4fbf7; border: 1px solid #d1fae5; border-radius: 8px; padding: 10px; display: flex; justify-content: space-between; align-items: center;">\n                        <div style="display: flex; flex-direction: column; overflow: hidden;">\n                            <span style="font-size: 11pt; font-weight: 900; color: #000; line-height: 1.2; margin-bottom: 2px;">'.concat(r,'</span>\n                            <span style="font-size: 11pt; color: #6b7280; line-height: 1.2; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">').concat(n,'</span>\n                        </div>\n                        <span style="font-size: 11pt; font-weight: 900; color: #16a34a; margin-left: 8px; white-space: nowrap;">$').concat(l.toFixed(2),"</span>\n                    </div>\n                ")});let x=new Blob([i+="</div></div></div>"],{type:"text/html"}),u=new Blob([i.replace(/<[^>]*>?/gm,"")],{type:"text/plain"});try{await navigator.clipboard.write([new ClipboardItem({"text/html":x,"text/plain":u})]),alert("Pool results copied to clipboard!")}catch(e){console.error(e),alert("Failed to copy")}};return(0,r.jsx)("button",{onClick:s,className:"p-2.5 bg-black rounded-lg hover:bg-gray-800 transition-colors shadow-sm text-white cursor-pointer",title:"Copy Results",children:(0,r.jsx)(o.A,{className:"w-5 h-5"})})}function F(e){let{allRounds:t,currentRoundId:l,onSelect:a}=e,s=(0,n.useRouter)();return(0,r.jsx)("select",{title:"Select Round Filter",className:"flex-1 mx-1 bg-white border border-gray-300 rounded-lg px-1 sm:px-1 py-2 sm:py-2.5 text-[14pt] font-bold text-gray-800 focus:outline-none focus:ring-2 focus:ring-green-500 appearance-none min-w-0 cursor-pointer hover:bg-gray-50 transition-colors",value:l,onChange:e=>{a?a(e.target.value):s.push("/pool?roundId=".concat(e.target.value))},children:t.map(e=>{var t;let l=(null===(t=e._count)||void 0===t?void 0:t.players)||0;if(l<12)return null;let[a,n,s]=e.date.split("T")[0].split("-").map(Number),o=(0,j.GP)(new Date(a,n-1,s,12,0,0),"MMM d, yyyy"),i=e.name?"".concat(e.name," (").concat(o,") - ").concat(l):"".concat(o," - ").concat(l);return(0,r.jsxs)("option",{value:e.id,children:[i,e.isTournament?" \uD83C\uDFC6":""]},e.id)})})}function D(e){let{roundId:t,isOpen:l,onClose:n}=e,[o,d]=(0,a.useState)(null),[c,x]=(0,a.useState)(!0),[u,p]=(0,a.useState)(null),[g,f]=(0,a.useState)(!1),[h,m]=(0,a.useState)(t);(0,a.useEffect)(()=>{let e=()=>{f("true"===s.A.get("admin_session"))};return e(),window.addEventListener("admin-change",e),()=>window.removeEventListener("admin-change",e)},[]),(0,a.useEffect)(()=>{l&&h&&(x(!0),p(null),b(h))},[l,h]),(0,a.useEffect)(()=>{l||m(t)},[t,l]);let b=async e=>{let t=await R(e);if(t.success&&t.data){let e=new Map(t.data.winningsArray);d({...t.data,winningsMap:e}),x(!1)}else p(t.error||"Failed to load pool data"),x(!1)};return l?(0,r.jsxs)("div",{className:"fixed inset-0 z-[100] flex flex-col bg-white overflow-hidden animate-in fade-in zoom-in duration-200",children:[(0,r.jsxs)("header",{className:"bg-white border-b border-gray-200 px-4 py-4 flex items-center justify-between shadow-sm sticky top-0 z-10",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("h2",{className:"text-[18pt] font-black text-green-600 leading-tight text-left ml-3",children:"$5 Pool Results"}),(null==o?void 0:o.round)&&(0,r.jsxs)("p",{className:"text-[12pt] text-gray-500 font-medium",children:[new Date(o.round.date).toLocaleDateString()," ",o.round.name?"- ".concat(o.round.name):""]})]}),(0,r.jsx)("button",{onClick:n,className:"px-4 py-2 bg-black text-white rounded-full text-[15pt] font-bold hover:bg-gray-800 transition-colors mr-3",children:"Close"})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto bg-gray-50",children:c?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center h-full space-y-4 py-20",children:[(0,r.jsx)("div",{className:"w-12 h-12 border-4 border-green-200 border-t-green-600 rounded-full animate-spin"}),(0,r.jsx)("p",{className:"text-[14pt] font-bold text-gray-500 animate-pulse",children:"Calculating Pots & Skins..."})]}):u?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center h-full p-8 text-center space-y-4",children:[(0,r.jsx)("div",{className:"bg-red-50 text-red-500 p-6 rounded-full",children:(0,r.jsx)(w.A,{className:"w-12 h-12"})}),(0,r.jsx)("h3",{className:"text-[16pt] font-bold text-gray-900",children:"Oops! Something went wrong"}),(0,r.jsx)("p",{className:"text-[14pt] text-gray-500 max-w-md",children:u}),(0,r.jsx)("button",{onClick:()=>b(h),className:"bg-black text-white px-6 py-2 rounded-full font-bold text-[14pt] hover:bg-gray-800 transition-colors",children:"Try Again"})]}):(0,r.jsxs)("main",{className:"px-1 py-4 max-w-5xl mx-auto w-full",children:[(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-1 flex items-center justify-between gap-1 mb-4 shadow-sm",children:[(0,r.jsx)(F,{allRounds:o.allRounds,currentRoundId:h,onSelect:e=>m(e)}),g&&(0,r.jsxs)("div",{className:"flex gap-1 shrink-0",children:[(0,r.jsx)(M,{date:o.round.date,roundName:o.round.name,isTournament:o.round.is_tournament,flights:o.processedFlights}),(0,r.jsx)("button",{className:"p-2.5 bg-black rounded-lg hover:bg-gray-800 transition-colors shadow-sm text-white cursor-pointer",children:(0,r.jsx)(i.A,{className:"w-5 h-5"})})]})]}),(0,r.jsxs)("div",{className:"border border-gray-300 rounded-2xl overflow-hidden shadow-xl bg-white mb-10",children:[(0,r.jsxs)("div",{className:"bg-[#f3f4fa] border-b border-gray-300 px-1 py-4 flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-[14pt] font-bold text-gray-700",children:"Pool Participants"}),(0,r.jsx)(P,{roundId:o.round.id,allPlayers:o.round.players.map(e=>({id:e.player_id,name:e.player.name})),currentParticipantIds:o.allPoolParticipants.map(e=>e.player_id)})]}),(0,r.jsx)(E,{allPoolParticipants:o.allPoolParticipants,poolActivePlayers:o.poolActivePlayers,round:o.round,flights:o.flights,processedFlights:o.processedFlights,winningsMap:o.winningsMap})]})]})})]}):null}let z=(0,x.createServerReference)("4075f3342e6d3a48d8836f55b1fbb6a90b543c7f9e",x.callServer,void 0,x.findSourceMapURL,"addGuestToLiveRound"),A=(0,x.createServerReference)("40d02882bbd968574d136b30792b70e02bba847d8a",x.callServer,void 0,x.findSourceMapURL,"updateGuestInLiveRound"),B=(0,x.createServerReference)("405955f419b11743d6d7dbb6f62f1a255da70c9235",x.callServer,void 0,x.findSourceMapURL,"deleteGuestFromLiveRound"),T=(0,x.createServerReference)("4082c09ee0a3d3c0abce26a561ec48999b51d2f067",x.callServer,void 0,x.findSourceMapURL,"saveLiveScore"),G=(0,x.createServerReference)("402987608957ba5a79535126794248fadd531c8ec1",x.callServer,void 0,x.findSourceMapURL,"deleteLiveRound"),O=(0,x.createServerReference)("40179cad928d59cabe33eb581332bb05b821dd37cc",x.callServer,void 0,x.findSourceMapURL,"copyLiveToClub"),H=(0,x.createServerReference)("40ec98da2cf06dc86cb574c105315afb1db2b5eb29",x.callServer,void 0,x.findSourceMapURL,"removePlayerFromLiveRound"),U=(0,x.createServerReference)("78d54b99254b315713f04e86320ffa065f0417bf83",x.callServer,void 0,x.findSourceMapURL,"sendScorecardEmail"),W=(0,x.createServerReference)("4083c3adc94b0336e5535c15ea070d95939c5ac7db",x.callServer,void 0,x.findSourceMapURL,"deleteUserLiveRound");function $(e){var t,l,x,u,g,f,w,j,N,k,S;let{allPlayers:C,defaultCourse:_,initialRound:E,todayStr:R,allLiveRounds:I,allCourses:L,isAdmin:P,currentUserId:M,lastUsedCourseId:F,lastUsedTeeBoxId:$}=e,J=(0,n.useRouter)(),[q,V]=(0,a.useState)((null==E?void 0:E.id)||null),[Y,K]=(0,a.useState)(P),[Q,X]=(0,a.useState)([]),[Z,ee]=(0,a.useState)(!1),[et,el]=(0,a.useState)(!1),[er,ea]=(0,a.useState)("new"),[en,es]=(0,a.useState)(!1),[eo,ei]=(0,a.useState)([]),[ed,ec]=(0,a.useState)(null),[ex,eu]=(0,a.useState)(!1),[ep,eg]=(0,a.useState)(!1),[ef,eh]=(0,a.useState)(!1),[em,eb]=(0,a.useState)(!1),[ev,ey]=(0,a.useState)([]),[ew,ej]=(0,a.useState)([]),[eN,ek]=(0,a.useState)(!1),[eS,eC]=(0,a.useState)(new Map),[e_,eE]=(0,a.useState)(null),[eR,eI]=(0,a.useState)(null),[eL,eP]=(0,a.useState)(!1),[eM,eF]=(0,a.useState)(null),[eD,ez]=(0,a.useState)("");(0,a.useEffect)(()=>{let e=localStorage.getItem("live_scoring_device_id");e||(e=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),localStorage.setItem("live_scoring_device_id",e)),ez(e)},[]),(0,a.useEffect)(()=>{if(!q)return;let e=localStorage.getItem("live_scoring_my_group_".concat(q));if(e)try{let t=JSON.parse(e),l=[...C,...eo],r=t.map(e=>l.find(t=>t.id===e)).filter(e=>void 0!==e);r.length>0&&X(r)}catch(e){console.error("Failed to restore selected players from localStorage:",e)}},[q,C,eo]);let eA=(e,t)=>{eF({isOpen:!0,title:e,message:t,onConfirm:()=>eF(null),hideCancel:!0,confirmText:"OK"})},eB=function(e,t,l){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];eF({isOpen:!0,title:e,message:t,onConfirm:()=>{l(),eF(null)},isDestructive:r})};(0,a.useEffect)(()=>{if(!navigator.geolocation||!eL){eL||eI(null);return}let e=null,t=null,l=(e,l)=>{if(!t)return!0;let r=t.latitude*Math.PI/180,a=e*Math.PI/180,n=(e-t.latitude)*Math.PI/180,s=(l-t.longitude)*Math.PI/180,o=Math.sin(n/2)*Math.sin(n/2)+Math.cos(r)*Math.cos(a)*Math.sin(s/2)*Math.sin(s/2);return 2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))*6371e3>5},r=(e,r)=>{l(e,r)&&(t={latitude:e,longitude:r},eI({latitude:e,longitude:r}))};return navigator.geolocation.getCurrentPosition(t=>{r(t.coords.latitude,t.coords.longitude),e=navigator.geolocation.watchPosition(e=>{r(e.coords.latitude,e.coords.longitude)},e=>{},{enableHighAccuracy:!0,timeout:3e4,maximumAge:5e3})},t=>{navigator.geolocation.getCurrentPosition(t=>{r(t.coords.latitude,t.coords.longitude),e=navigator.geolocation.watchPosition(e=>{r(e.coords.latitude,e.coords.longitude)},()=>{},{enableHighAccuracy:!1,timeout:6e4,maximumAge:3e4})},()=>{},{enableHighAccuracy:!1,timeout:6e4,maximumAge:3e4})},{enableHighAccuracy:!1,timeout:2e4,maximumAge:1e4}),()=>{null!==e&&navigator.geolocation.clearWatch(e)}},[eL]),(0,a.useEffect)(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]);let eT=(e,t,l,r)=>{let a=e*Math.PI/180,n=l*Math.PI/180,s=(l-e)*Math.PI/180,o=(r-t)*Math.PI/180,i=Math.sin(s/2)*Math.sin(s/2)+Math.cos(a)*Math.cos(n)*Math.sin(o/2)*Math.sin(o/2);return Math.round(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))*6967389.31)};(0,a.useEffect)(()=>{try{let e=null==E?void 0:E.id;if(!e)return;localStorage.setItem("live_scoring_last_round_id",e);let t=[];(null==E?void 0:E.players)&&E.players.forEach(e=>{e.is_guest&&t.push({id:e.id,name:e.guest_name||"Guest",index:e.index_at_time,preferred_tee_box:null,isGuest:!0,liveRoundData:{tee_box_name:e.tee_box_name,course_hcp:e.course_handicap}})}),ei(t);let l=localStorage.getItem("live_scoring_my_group_".concat(e));if(l){let e=JSON.parse(l),r=[...C,...t],a=e.map(e=>r.find(t=>t.id===e)).filter(e=>void 0!==e);if(a.length>0)X(a);else if(Y&&(null==E?void 0:E.players)){let e=[];E.players.forEach(t=>{t.is_guest?e.push({id:t.id,name:t.guest_name||"Guest",index:t.index_at_time,preferred_tee_box:null,isGuest:!0,liveRoundData:{tee_box_name:t.tee_box_name,course_hcp:t.course_handicap}}):e.push({id:t.player.id,name:t.player.name,index:t.player.index,preferred_tee_box:t.player.preferred_tee_box,liveRoundData:{tee_box_name:t.tee_box_name,course_hcp:t.course_handicap}})}),X(e)}else X([])}else if(Y&&(null==E?void 0:E.players)){let e=[];E.players.forEach(t=>{t.is_guest?e.push({id:t.id,name:t.guest_name||"Guest",index:t.index_at_time,preferred_tee_box:null,isGuest:!0,liveRoundData:{tee_box_name:t.tee_box_name,course_hcp:t.course_handicap}}):e.push({id:t.player.id,name:t.player.name,index:t.player.index,preferred_tee_box:t.player.preferred_tee_box,liveRoundData:{tee_box_name:t.tee_box_name,course_hcp:t.course_handicap}})}),X(e)}else X([])}catch(e){console.error("Failed to load saved players",e),X([]),ei([])}},[E,Y]);let[eG,eO]=(0,a.useState)(()=>{let e=new Map;return(null==E?void 0:E.players)&&E.players.forEach(t=>{let l=new Map;t.scores&&t.scores.forEach(e=>{var t;(null===(t=e.hole)||void 0===t?void 0:t.holeNumber)&&l.set(e.hole.holeNumber,e.strokes)});let r=t.is_guest?t.id:t.player.id;e.set(r,l)}),e});(0,a.useEffect)(()=>{if(null==E?void 0:E.players){if(eD){let e=new Set;E.players.forEach(t=>{let l=t.is_guest?t.id:t.player.id;t.scorer_id&&t.scorer_id!==eD&&e.add(l)}),e.size>0&&X(t=>{if(!t.some(t=>e.has(t.id)))return t;let l=t.filter(t=>!e.has(t.id));return q&&localStorage.setItem("live_scoring_my_group_".concat(q),JSON.stringify(l.map(e=>e.id))),l})}eO(e=>{let t=new Map(e);return E.players.forEach(e=>{let l=new Map;e.scores&&e.scores.forEach(e=>{var t;(null===(t=e.hole)||void 0===t?void 0:t.holeNumber)&&l.set(e.hole.holeNumber,e.strokes)});let r=e.is_guest?e.id:e.player.id;t.set(r,l)}),t})}},[E]);let eH=(0,a.useRef)(new Map),eU=(0,a.useRef)(new Map),eW=(0,a.useRef)(!1),e$=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(!(null==E?void 0:E.players)||!_)return;e$.current!==E.id&&(eH.current.clear(),eU.current.clear(),eW.current=!1,e$.current=E.id);let e=[],t=[];E.players.forEach(l=>{let r=l.is_guest?l.id:l.player.id;eH.current.has(r)||eH.current.set(r,new Set),eU.current.has(r)||eU.current.set(r,new Set);let a=eU.current.get(r),n=eH.current.get(r),s=!1,o=!1;l.scores&&l.scores.forEach(e=>{var t;if((null===(t=e.hole)||void 0===t?void 0:t.holeNumber)&&e.strokes){let t=_.holes.find(t=>t.holeNumber===e.hole.holeNumber);if(t){let l=e.strokes-t.par;-1===l&&!n.has(e.hole.holeNumber)&&(n.add(e.hole.holeNumber),eW.current&&(s=!0)),l<=-2&&!a.has(e.hole.holeNumber)&&(a.add(e.hole.holeNumber),eW.current&&(o=!0))}}}),s&&e.push({name:l.is_guest?l.guest_name||"Guest":l.player.name,totalBirdies:n.size}),o&&t.push({name:l.is_guest?l.guest_name||"Guest":l.player.name,totalEagles:a.size})}),e.length>0&&ey(t=>{let l=new Set(t.map(e=>e.name)),r=e.filter(e=>!l.has(e.name));return 0===r.length?t:[...t,...r]}),t.length>0&&ej(e=>{let l=new Set(e.map(e=>e.name)),r=t.filter(e=>!l.has(e.name));return 0===r.length?e:[...e,...r]}),eW.current=!0},[E,_]);let[eJ,eq]=(0,a.useState)(!1),eV=(0,n.useSearchParams)(),[eY,eK]=(0,a.useState)(()=>{let e=eV.get("hole");if(e){let t=parseInt(e);if(t>=1&&t<=18)return t}if(!(null==E?void 0:E.players)||0===E.players.length)return 1;for(let e=1;e<=18;e++)if(!E.players.every(t=>t.scores&&t.scores.some(t=>{var l;return(null===(l=t.hole)||void 0===l?void 0:l.holeNumber)===e})))return e;return 1});(0,a.useEffect)(()=>{if(!(null==E?void 0:E.id))return;let e=localStorage.getItem("live_scoring_active_hole_".concat(E.id));if(e&&!eV.get("hole")){let t=parseInt(e);t>=1&&t<=18&&t!==eY&&eK(t)}},[null==E?void 0:E.id]),(0,a.useEffect)(()=>{if(q&&localStorage.setItem("live_scoring_active_hole_".concat(q),eY.toString()),eV.get("hole")===eY.toString())return;let e=new URLSearchParams(eV.toString());e.set("hole",eY.toString()),J.replace("?".concat(e.toString()),{scroll:!1})},[eY,q,eV,J]),(0,a.useEffect)(()=>{ek(!1),eC(new Map)},[eY]),(0,a.useEffect)(()=>{let e=()=>{K("true"===s.A.get("admin_session"))};return e(),window.addEventListener("admin-change",e),()=>window.removeEventListener("admin-change",e)},[]);let[eQ,eX]=(0,a.useState)(!0),eZ=(null==E?void 0:E.date)||R,e0=R>eZ,e1=Y||!e0,e2=(null==_?void 0:null===(t=_.holes.find(e=>e.holeNumber===eY))||void 0===t?void 0:t.par)||4;null==_||null===(l=_.holes.find(e=>e.holeNumber===eY))||void 0===l||l.difficulty;let e4=e=>{let t=e.trim().split(" ");if(1===t.length)return{first:t[0],last:""};let l=t[t.length-1];return{first:t.slice(0,-1).join(" "),last:l}},e5=(e,t)=>{var l,r,a;return t===eY&&eS.has(e)?null!==(r=eS.get(e))&&void 0!==r?r:null:null!==(a=null===(l=eG.get(e))||void 0===l?void 0:l.get(t))&&void 0!==a?a:null},e3=(e,t)=>{var l,r;return null!==(r=null===(l=eG.get(e))||void 0===l?void 0:l.get(t))&&void 0!==r?r:null},e8=e=>{if(!_)return null;if(e.preferred_tee_box){let t=_.teeBoxes.find(t=>{var l;return t.name.toLowerCase()===(null===(l=e.preferred_tee_box)||void 0===l?void 0:l.toLowerCase())});if(t)return t;let l=_.teeBoxes.find(t=>t.name.toLowerCase().includes(e.preferred_tee_box.toLowerCase()));if(l)return l}if((null==E?void 0:E.rating)&&(null==E?void 0:E.slope)){let e=_.teeBoxes.find(e=>e.rating===E.rating&&e.slope===E.slope);if(e)return e}return _.teeBoxes.find(e=>e.name.toLowerCase().includes("white"))||_.teeBoxes[0]},e6=e=>{var t,l;if((null===(t=e.liveRoundData)||void 0===t?void 0:t.course_hcp)!==void 0&&null!==e.liveRoundData.course_hcp)return e.liveRoundData.course_hcp;let r=e8(e);if(!r)return 0;let a=r.rating,n=r.slope,s=null!==(l=null==E?void 0:E.par)&&void 0!==l?l:(null==_?void 0:_.holes.reduce((e,t)=>e+t.par,0))||72;return Math.round(e.index*n/113+(a-s))},e9=async e=>{if(!q||!E){eA("Error","No active live round found");return}console.log("Adding guest to database:",e);let t=await z({liveRoundId:q,guestName:e.name,index:e.index,courseHandicap:e.courseHandicap,rating:E.rating,slope:E.slope,par:E.par,scorerId:Y?void 0:eD});if(t.success&&t.guestPlayerId){console.log("Guest added successfully, refreshing page");let e=localStorage.getItem("live_scoring_my_group"),l=e?JSON.parse(e):[];l.includes(t.guestPlayerId)||(l.push(t.guestPlayerId),localStorage.setItem("live_scoring_my_group_".concat(q),JSON.stringify(l))),J.refresh()}else eA("Error","Failed to add guest: "+t.error)},e7=async(e,t)=>{console.log("Updating guest in database:",e,t);let l=await A({guestPlayerId:e,guestName:t.name,index:t.index,courseHandicap:t.courseHandicap});l.success?(console.log("Guest updated successfully, refreshing page"),ec(null),J.refresh()):eA("Error","Failed to update guest: "+l.error)},te=async e=>{console.log("Deleting guest from database:",e);let t=await B(e);t.success?(console.log("Guest deleted successfully, refreshing page"),es(!1),ec(null),J.refresh()):eA("Error","Failed to delete guest: "+t.error)},tt=async e=>{if(!q){eA("Error","No live round selected");return}let t=await O({liveRoundId:q,playerIds:e});t.success?eA("Success",t.message||"Successfully copied to club scores!"):eA("Error","Failed to copy: "+t.error)},tl=(e,t)=>{let l=[...Q],r="up"===t?e-1:e+1;r>=0&&r<l.length&&([l[e],l[r]]=[l[r],l[e]],X(l),localStorage.setItem("live_scoring_my_group_".concat(q),JSON.stringify(l.map(e=>e.id))))},tr=async e=>{let t=[...C,...eo],l=e.map(e=>t.find(t=>t.id===e)).filter(e=>void 0!==e);X(l);let r=l.filter(e=>!e.isGuest&&!e.id.startsWith("guest-"));if(!q){eA("No Round Selected","Please create a new round or select an existing round before adding players.");return}for(let e of r){var a;let t=null==E?void 0:null===(a=E.players)||void 0===a?void 0:a.find(t=>{var l;return(null===(l=t.player)||void 0===l?void 0:l.id)===e.id}),l=!t,r=t&&t.scorer_id!==eD&&!Y;if(l||r){let t=e8(e);q&&(null==t?void 0:t.id)&&(console.log(l?"Creating player in round:":"Claiming player from other device:",e.name),await h({liveRoundId:q,playerId:e.id,teeBoxId:t.id,scorerId:Y?void 0:eD}))}}let n=Q.filter(t=>!e.includes(t.id));if(q&&(null==E?void 0:E.players)){let e=[];for(let t of n){let l=E.players.find(e=>{var l;return e.is_guest&&e.id===t.id||!e.is_guest&&(null===(l=e.player)||void 0===l?void 0:l.id)===t.id});if(l){let r=l.scores&&l.scores.length>0;console.log("Removing player from round:",l.id,r?"(has scores)":"(no scores)","scorer_id:",l.scorer_id,"client:",eD);try{let r=await H(l.id);r.success?console.log(" Successfully removed player:",l.id):r.error&&(r.error.includes("does not exist")||r.error.includes("Record to delete"))?console.log(" Player already removed (concurrency):",l.id):(console.error(" Failed to remove player:",l.id,r.error),eA("Error","Failed to remove player: ".concat(r.error||"Unknown error")),e.push(t))}catch(r){console.error(" Error removing player:",r);let l=String(r);l.includes("does not exist")||l.includes("Record to delete")||(eA("Error","Error removing player: ".concat(r)),e.push(t))}}}e.length>0&&X(t=>{let l=new Set(t.map(e=>e.id));return[...t,...e.filter(e=>!l.has(e.id))]}),J.refresh()}},ta=(e,t)=>{var l,r,a;if(!q){console.warn("No live round ID available to save score.");return}let n=null===(l=eG.get(e))||void 0===l?void 0:l.get(eY),s=null!==(a=null!==(r=eS.get(e))&&void 0!==r?r:n)&&void 0!==a?a:e2,o=t?s+1:s-1;o<1&&(o=1),eC(t=>{let l=new Map(t);return l.set(e,o),l}),ek(!0)},tn=async(e,t,l)=>{if(!q)return;let r=parseInt(l);if(!isNaN(r)&&!(r<0)){eO(l=>{let a=new Map(l),n=new Map(a.get(e)||new Map);return n.set(t,r),a.set(e,n),a});try{await T({liveRoundId:q,holeNumber:t,playerScores:[{playerId:e,strokes:r}],scorerId:Y?void 0:eD})}catch(e){console.error("Admin summary save failed:",e)}}};(0,a.useEffect)(()=>{q&&localStorage.setItem("live_scoring_my_group_".concat(q),JSON.stringify(Q.map(e=>e.id)))},[Q,q]),(0,a.useEffect)(()=>{if(!q||!(null==E?void 0:E.players)||0===Q.length||Y)return;let e=Q.filter(e=>{if(e.isGuest)return!1;let t=E.players.find(t=>{var l;return(null===(l=t.player)||void 0===l?void 0:l.id)===e.id});return!!t&&!!t.scorer_id&&t.scorer_id!==eD});e.length>0&&(console.log("Ownership lost for players (Stolen by another device):",e.map(e=>e.name)),X(t=>t.filter(t=>!e.some(e=>e.id===t.id))))},[E,Q,eD,Y,q]),(0,a.useEffect)(()=>{if(!q||!M||Q.length>0||Y||!(null==E?void 0:E.players))return;let e=E.players.find(e=>{var t;return(null===(t=e.player)||void 0===t?void 0:t.id)===M});if(e){let t={id:e.player.id,name:e.player.name,index:e.player.index,preferred_tee_box:e.player.preferred_tee_box,liveRoundPlayerId:e.id,scorerId:e.scorer_id,liveRoundData:{tee_box_name:e.tee_box_name,course_hcp:e.course_handicap}};console.log("Auto-selecting current user for scoring:",t.name),X([t])}},[E,M,Q.length,Y,q]),(0,a.useEffect)(()=>{q&&eX(!0)},[q]);let ts=(0,a.useMemo)(()=>{let e=new Map;return(null==E?void 0:E.players)&&E.players.forEach(t=>{t.is_guest?e.set(t.id,{id:t.id,name:t.guest_name||"Guest",index:t.index_at_time,preferred_tee_box:null,isGuest:!0,liveRoundPlayerId:t.id,scorerId:t.scorer_id,liveRoundData:{tee_box_name:t.tee_box_name,course_hcp:t.course_handicap}}):t.player&&e.set(t.player.id,{id:t.player.id,name:t.player.name,index:t.player.index,preferred_tee_box:t.player.preferred_tee_box,liveRoundPlayerId:t.id,scorerId:t.scorer_id,liveRoundData:{tee_box_name:t.tee_box_name,course_hcp:t.course_handicap}})}),Q.forEach(t=>{e.has(t.id)||e.set(t.id,t)}),Array.from(e.values())},[E,Q]),to=Y?ts:Q.length>0?Q:[];to.length>0&&to.every(e=>{let t=eG.get(e.id);if(!t)return!1;for(let e=1;e<=18;e++)if(!t.has(e))return!1;return!0});let ti=ts.map(e=>{let t=eG.get(e.id),l=0,r=0,a=0,n=0,s=0,o=0,i=e6(e),d=[];t&&t.forEach((e,t)=>{l+=e,t<=9?r+=e:a+=e;let c=null==_?void 0:_.holes.find(e=>e.holeNumber===t),x=(null==c?void 0:c.par)||4,u=(null==c?void 0:c.difficulty)||t;d.push({difficulty:u,grossScore:e});let p=0;i>0&&(p=Math.floor(i/18)+(u<=i%18?1:0)),n+=p,s+=x,o++}),d.sort((e,t)=>e.difficulty-t.difficulty);let c=l-n,x=l-s;return{...e,totalGross:l,front9:r,back9:a,strokesReceivedSoFar:n,courseHcp:i,totalNet:c,thru:o,toPar:x,parTotal:s,grossHoleScores:d}}).sort((e,t)=>{if(e.totalNet!==t.totalNet)return e.totalNet-t.totalNet;let l=Math.min(e.grossHoleScores.length,t.grossHoleScores.length);for(let r=0;r<l;r++)if(e.grossHoleScores[r].grossScore!==t.grossHoleScores[r].grossScore)return e.grossHoleScores[r].grossScore-t.grossHoleScores[r].grossScore;return 0}),td=ti.filter(e=>e.thru>0);td.length>0&&td.every(e=>e.thru>=18),ti.length>0&&ti.every(e=>e.thru>=18);let tc=ti.map(e=>{let t=eG.get(e.id),l=0,r=0;return t&&t.forEach((e,t)=>{let a=null==_?void 0:_.holes.find(e=>e.holeNumber===t),n=e-((null==a?void 0:a.par)||4);-1===n&&l++,n<=-2&&r++}),{...e,birdieCount:l,eagleCount:r}}),tx=tc.filter(e=>e.birdieCount>0).sort((e,t)=>t.birdieCount-e.birdieCount),tu=tc.filter(e=>e.eagleCount>0).sort((e,t)=>t.eagleCount-e.eagleCount);return E||q||et?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 pb-20 text-black",children:[(0,r.jsx)("header",{className:"bg-white shadow-sm sticky top-0 z-50 px-1 py-1",children:(0,r.jsx)("div",{className:"w-full flex justify-between items-center",children:(0,r.jsx)("h1",{className:"text-[18pt] font-bold text-green-700 tracking-tight flex-1 text-left ml-3",children:"Live Scoring"})})}),(0,r.jsxs)("main",{className:"w-full px-1 pt-1 m-0 space-y-1",children:[eQ&&(0,r.jsxs)("div",{className:"min-h-[80px] bg-white rounded-xl shadow-lg p-1 border-4 border-gray-300 flex flex-col justify-center",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,r.jsx)("label",{htmlFor:"round-selector",className:"text-[15pt] font-bold text-gray-900 ml-1",children:"Select Round:"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[q&&Y&&(0,r.jsx)("button",{onClick:()=>eu(!0),className:"bg-green-600 text-white text-[15pt] font-bold px-4 py-2 rounded-full hover:bg-green-700 transition-all shadow-md active:scale-95",children:"Transfer"}),Y&&q&&(0,r.jsx)("button",{onClick:()=>{q&&eF({isOpen:!0,title:"Delete Live Round",message:"Are you sure you want to delete this live round? This action cannot be undone.",isDestructive:!0,onConfirm:async()=>{eF(null);try{console.log("Attempting to delete round:",q);let e=await G(q);console.log("Delete result:",e),e.success?window.location.href="/":(console.error("Delete failed on server:",e.error),eA("Error","Failed to delete: "+e.error))}catch(e){console.error("Failed to delete round (client error):",e),eA("Error","Failed to delete round (network/client error).")}}})},className:"bg-red-600 text-white text-[15pt] font-bold px-4 py-2 rounded-full hover:bg-red-700 transition-all shadow-md active:scale-95",children:"Delete"}),!Y&&q&&(0,r.jsx)("button",{onClick:()=>{let e=I.find(e=>e.id===q);e&&eF({isOpen:!0,title:"Delete Round",message:'Are you sure you want to delete "'.concat(e.name,'" (').concat(e.date,")? This action cannot be undone."),isDestructive:!0,onConfirm:async()=>{eF(null);try{let e=await W(q);e.success?window.location.href="/":eA("Error",e.error||"Failed to delete round")}catch(e){console.error("Failed to delete round:",e),eA("Error","Failed to delete round")}}})},className:"bg-red-600 text-white text-[15pt] font-bold px-4 py-2 rounded-full hover:bg-red-700 transition-all shadow-md active:scale-95",children:"Delete"}),(0,r.jsx)("button",{onClick:()=>{q?ea("edit"):ea("new"),el(!0)},className:"px-4 py-2 bg-black text-white rounded-full text-[15pt] font-bold hover:bg-gray-800 transition-colors shadow-md active:scale-95",children:"New"})]})]}),(0,r.jsxs)("button",{onClick:()=>eb(!0),className:"flex-1 px-4 py-2 text-[15pt] bg-black text-white rounded-full font-bold hover:bg-gray-800 transition-colors flex justify-between items-center min-w-0",children:[(0,r.jsx)("span",{className:"truncate mr-2",children:(()=>{if(!q)return"-- Select a Round --";let e=I.find(e=>e.id===q);if(!e)return"-- Select a Round --";let t=e.date?new Date(e.date+"T12:00:00").toLocaleDateString("en-US",{weekday:"short"}):"";return t?"".concat(t," - ").concat(e.name.replace("New Orleans","").trim()):e.name.replace("New Orleans","").trim()})()}),(0,r.jsx)("span",{className:"text-sm",children:""})]}),em&&(0,r.jsxs)("div",{className:"fixed inset-0 z-[100] bg-white flex flex-col animate-in slide-in-from-bottom-5 duration-200",children:[(0,r.jsxs)("div",{className:"bg-black text-white px-4 py-4 flex justify-between items-center shadow-md shrink-0",children:[(0,r.jsx)("h2",{className:"text-[18pt] font-bold",children:"Select Round"}),(0,r.jsx)("button",{onClick:()=>eb(!1),className:"text-white p-2 rounded-full hover:bg-gray-800",children:(0,r.jsx)("span",{className:"text-[20pt] leading-none",children:""})})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-2 bg-gray-50",children:I.map(e=>{let t=e.date?new Date(e.date+"T12:00:00").toLocaleDateString("en-US",{weekday:"short"}):"",l=e.id===q;return(0,r.jsx)("button",{onClick:()=>{eb(!1),e.id!==q&&(window.location.href="/?roundId=".concat(e.id))},className:"w-full text-left p-1 rounded-xl shadow-sm border transaction-all active:scale-[0.98] ".concat(l?"bg-green-50 border-green-500 ring-1 ring-green-500":"bg-white border-gray-200 hover:border-gray-300"),children:(0,r.jsx)("div",{className:"flex flex-col",children:(0,r.jsxs)("span",{className:"text-[16pt] font-bold ".concat(l?"text-green-700":"text-gray-900"),children:[t?"".concat(t," - "):"",e.name.replace("New Orleans","").trim()]})})},e.id)})})]})]}),eQ&&(0,r.jsx)("div",{className:"bg-white text-black rounded-xl shadow-lg p-1 border-4 border-gray-300",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("h2",{className:"text-[15pt] font-bold text-gray-900",children:(null==_?void 0:_.name)||"Round"}),e0&&(0,r.jsx)("span",{className:"bg-red-100 text-red-700 text-[10pt] font-black px-2 py-0.5 rounded-full uppercase",children:"Locked"})]}),(0,r.jsxs)("div",{className:"flex flex-nowrap gap-x-2 text-[13pt] text-gray-500 mt-1 overflow-x-auto",children:[(0,r.jsx)("span",{className:"whitespace-nowrap",children:(null==E?void 0:E.date)||R}),(0,r.jsxs)("span",{className:"whitespace-nowrap",children:["P:",null!==(N=null==E?void 0:E.par)&&void 0!==N?N:null==_?void 0:null===(x=_.holes)||void 0===x?void 0:x.reduce((e,t)=>e+t.par,0)]}),(0,r.jsxs)("span",{className:"whitespace-nowrap",children:["R:",null!==(k=null==E?void 0:E.rating)&&void 0!==k?k:null==_?void 0:null===(g=_.teeBoxes)||void 0===g?void 0:null===(u=g[0])||void 0===u?void 0:u.rating]}),(0,r.jsxs)("span",{className:"whitespace-nowrap",children:["S:",null!==(S=null==E?void 0:E.slope)&&void 0!==S?S:null==_?void 0:null===(w=_.teeBoxes)||void 0===w?void 0:null===(f=w[0])||void 0===f?void 0:f.slope]}),(()=>{var e;let t=null==_?void 0:null===(e=_.teeBoxes)||void 0===e?void 0:e.find(e=>{var t,l,r,a,n,s;return e.rating===(null!==(n=null==E?void 0:E.rating)&&void 0!==n?n:null==_?void 0:null===(l=_.teeBoxes)||void 0===l?void 0:null===(t=l[0])||void 0===t?void 0:t.rating)&&e.slope===(null!==(s=null==E?void 0:E.slope)&&void 0!==s?s:null==_?void 0:null===(a=_.teeBoxes)||void 0===a?void 0:null===(r=a[0])||void 0===r?void 0:r.slope)}),l=(null==t?void 0:t.name)||"",a=l.toLowerCase().includes("white")?"W":l.toLowerCase().includes("gold")?"G":l.charAt(0).toUpperCase();return a&&(0,r.jsx)("span",{className:"px-2 py-0.5 rounded text-[12pt] font-bold bg-white text-black border border-black whitespace-nowrap",children:a})})()]})]}),(0,r.jsx)("div",{className:"flex flex-col gap-1",children:e1&&!e0&&(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("button",{onClick:()=>eq(!0),className:"bg-black text-white text-[15pt] font-bold px-3 py-1 rounded-full hover:bg-gray-800 transition-all shadow-md active:scale-95",children:"Players"}),(0,r.jsx)("button",{onClick:()=>{ea("edit"),el(!0)},className:"bg-black text-white text-[15pt] font-bold px-3 py-1 rounded-full hover:bg-gray-800 transition-all shadow-md active:scale-95",children:"Course"})]})})]})}),(0,r.jsx)(m,{isOpen:et,onClose:()=>el(!1),courseId:F||(null==_?void 0:_.id)||void 0,defaultTeeBoxId:$||void 0,existingRound:"edit"===er?E:null,allCourses:L,showAlert:eA,currentUserId:M}),(0,r.jsx)(p,{isOpen:eJ,onClose:()=>eq(!1),allPlayers:[...C,...eo],selectedIds:Q.map(e=>e.id),playersInRound:(null==E?void 0:null===(j=E.players)||void 0===j?void 0:j.map(e=>{var t;return null===(t=e.player)||void 0===t?void 0:t.id}).filter(e=>e))||[],onSelectionChange:tr,isAdmin:Y,currentUserId:M,courseData:_?{courseName:_.name,teeBoxes:_.teeBoxes,par:_.holes.reduce((e,t)=>e+t.par,0),roundTeeBox:E?{rating:E.rating,slope:E.slope}:null}:null}),(0,r.jsx)(v,{isOpen:en,onClose:()=>{es(!1),ec(null)},onAdd:e9,onUpdate:e7,onDelete:te,editingGuest:ed,roundData:E?{rating:E.rating,slope:E.slope,par:E.par}:null}),E&&(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border-2 border-black my-1 p-2",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-1 border-b border-gray-100 pb-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("h2",{className:"text-[15pt] font-black text-gray-900 tracking-tight shrink-0",children:"GPS"}),e1&&(0,r.jsx)("button",{onClick:()=>eP(!eL),className:"px-4 py-1 rounded-full text-[15pt] font-bold transition-all shadow-sm active:scale-95 ".concat(eL?"bg-green-600 text-white hover:bg-green-700":"bg-gray-300 text-gray-700 hover:bg-gray-400"),children:eL?"\uD83D\uDEF0 ON":"\uD83D\uDEF0 OFF"})]}),(0,r.jsxs)("button",{onClick:()=>eX(!eQ),className:"px-4 py-1 bg-black text-white rounded-full text-[15pt] font-bold hover:bg-gray-800 transition-colors shadow-md active:scale-95",children:["Details ",eQ?"":""]})]}),eL&&e1&&(0,r.jsx)("div",{className:"min-h-[140px] flex flex-col justify-center",children:(()=>{let e=null==_?void 0:_.holes.find(e=>e.holeNumber===eY);if(!eR)return(0,r.jsx)("div",{className:"bg-gray-100 text-gray-500 p-1 rounded-xl border-2 border-dashed border-gray-300 text-center mb-2 shadow-inner",children:(0,r.jsx)("p",{className:"font-medium text-[15pt] animate-pulse py-6",children:"\uD83D\uDEF0 Waiting for GPS..."})});if(!(null==e?void 0:e.latitude)||!(null==e?void 0:e.longitude))return(0,r.jsx)("div",{className:"bg-yellow-50 text-yellow-700 p-1 rounded-xl text-center mb-2 shadow-inner border-2 border-yellow-400",children:(0,r.jsxs)("p",{className:"font-medium text-[15pt] py-6",children:["\uD83D\uDCCD Coordinates missing for Hole ",eY]})});let t=eT(eR.latitude,eR.longitude,Number(e.latitude),Number(e.longitude)),l=(t,l)=>{var r;return null===(r=e.elements)||void 0===r?void 0:r.find(e=>e.side===t&&e.elementNumber===l)},a=(e,t,a)=>{let n=l(e,t);if(!n)return null;let s=n.frontLatitude&&n.frontLongitude?eT(eR.latitude,eR.longitude,Number(n.frontLatitude),Number(n.frontLongitude)):null,o=n.backLatitude&&n.backLongitude?eT(eR.latitude,eR.longitude,Number(n.backLatitude),Number(n.backLongitude)):null;if(!s&&!o&&!n.water&&!n.bunker&&!n.tree)return null;let i=(0,r.jsxs)("div",{className:"flex gap-0.5",children:[n.water&&(0,r.jsx)("span",{children:"\uD83D\uDCA7"}),n.bunker&&(0,r.jsx)("div",{className:"w-7 h-7 bg-[#d2b48c] border border-black/20 rounded-full"}),n.tree&&(0,r.jsx)("span",{children:"\uD83C\uDF33"})]}),d=(0,r.jsxs)("div",{className:"flex flex-col ".concat("LEFT"===e?"items-end":"items-start"," leading-none"),children:[(0,r.jsx)("span",{className:null===o?"invisible":"",children:null!=o?o:"--"}),(0,r.jsx)("span",{className:null===s?"invisible":"",children:null!=s?s:"--"})]});return(0,r.jsx)("div",{className:"absolute ".concat(a," flex items-center gap-1 text-white text-[22pt] font-extrabold z-10 drop-shadow-[0_2px_2px_rgba(0,0,0,0.8)]"),children:"LEFT"===e?(0,r.jsxs)(r.Fragment,{children:[d,i]}):(0,r.jsxs)(r.Fragment,{children:[i,d]})})};return(0,r.jsxs)("div",{className:"bg-green-600 text-white w-full mx-auto p-1 rounded-xl text-center mb-2 border-2 border-black shadow-inner relative overflow-hidden",children:[a("LEFT",2,"top-2 left-2"),a("LEFT",1,"bottom-2 left-2"),a("RIGHT",2,"top-2 right-2"),a("RIGHT",1,"bottom-2 right-2"),(0,r.jsx)("p",{className:"font-black text-[90pt] leading-none flex items-center justify-center pt-2 pb-4",children:t||(0===t?"0":"--")})]})})()}),(0,r.jsx)("div",{className:"grid grid-cols-6 gap-1",children:null==_?void 0:_.holes.map(e=>{let t=Q.length>0?Q:ti,l=t.some(t=>{let l=eG.get(t.id);return l&&l.has(e.holeNumber)}),a=eY===e.holeNumber,n=t.length>0&&!a&&!l&&e.holeNumber<eY,s="bg-white text-black border border-black";return a?s="bg-blue-600 text-white ring-2 ring-blue-600 ring-offset-1 z-10 scale-105 shadow-md":n?s="bg-[#ff3b30] text-white border-[#ff3b30]":l&&(s="bg-black text-white border border-black"),(0,r.jsx)("button",{onClick:()=>eK(e.holeNumber),className:"\n                                            flex flex-col items-center justify-center py-3 rounded-2xl transition-all\n                                            ".concat(s,"\n                                        "),children:(0,r.jsxs)("div",{className:"flex items-baseline",children:[(0,r.jsx)("span",{className:"text-[20pt] font-black leading-none",children:e.holeNumber}),(0,r.jsxs)("span",{className:"text-[15pt] font-bold leading-none opacity-80",children:["/",e.par]})]})},e.holeNumber)})})]}),e1&&(0,r.jsxs)("div",{id:"scoring-section",className:"bg-white text-black rounded-xl shadow-lg border-2 border-black my-1 py-0 px-2",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-0",children:[(0,r.jsxs)("h2",{className:"text-[14pt] font-black text-gray-900 tracking-tight",children:["Players (",to.length,")"]}),to.length>0&&(0,r.jsx)("button",{onClick:()=>{var e;if(!q||Z)return;ee(!0);let t=[],l=new Map(eG),r=to.every(e=>{let t=eG.get(e.id);return t&&t.has(eY)}),a=[],n=[],s=(null==_?void 0:null===(e=_.holes.find(e=>e.holeNumber===eY))||void 0===e?void 0:e.par)||4;to.forEach(e=>{var r;let o=new Map(l.get(e.id)||[]),i=eS.get(e.id),d=o.get(eY),c=null!==(r=null!=i?i:d)&&void 0!==r?r:s;if(o.set(eY,c),l.set(e.id,o),t.push({playerId:e.id,strokes:c}),c===s-1){eH.current.has(e.id)||eH.current.set(e.id,new Set);let t=eH.current.get(e.id).has(eY);if(eH.current.get(e.id).add(eY),!t){let t=0;o.forEach((e,l)=>{let r=null==_?void 0:_.holes.find(e=>e.holeNumber===l);e===((null==r?void 0:r.par)||4)-1&&t++}),a.push({name:e.name,totalBirdies:t})}}if(c<=s-2){eU.current.has(e.id)||eU.current.set(e.id,new Set);let t=eU.current.get(e.id).has(eY);if(eU.current.get(e.id).add(eY),!t){let t=0;o.forEach((e,l)=>{let r=null==_?void 0:_.holes.find(e=>e.holeNumber===l);e<=((null==r?void 0:r.par)||4)-2&&t++}),n.push({name:e.name,totalEagles:t})}}}),eO(l),a.length>0&&ey(a),n.length>0&&ej(n),eC(new Map),ek(!1);let o=eY;if(!r){if(eY<18)o=eY+1;else{let e=1;for(let t=1;t<=18;t++)if(to.some(e=>{let r=l.get(e.id);return!r||!r.has(t)})){e=t;break}o=e}eK(o),eX(!1)}ee(!1),t.length>0&&T({liveRoundId:q,holeNumber:eY,playerScores:t,scorerId:eD}).then(e=>{if(!e.success){console.error("Save failed:",e.error),e.error&&e.error.includes("locked by another device")?(eA("Error",e.error),J.refresh()):eA("Error","Failed to save scores: "+(e.error||"Unknown error"));return}J.refresh()}).catch(e=>{console.error("Background save failed:",e),eA("Error","Failed to save scores to server. Please check your connection.")})},disabled:Z,className:"".concat((()=>{let e=to.every(e=>{let t=eG.get(e.id);return t&&t.has(eY)});return eN||!e?"bg-blue-600 hover:bg-blue-700":"bg-black hover:bg-gray-800"})()," w-auto whitespace-nowrap text-white font-bold px-8 py-2 mt-1 rounded-full shadow-sm transition-colors text-[20pt] flex items-center justify-center gap-2 ").concat(Z?"opacity-70 disabled:cursor-not-allowed":""),children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("span",{className:Z?"invisible":"visible",children:["Save Hole ",eY]}),Z&&(0,r.jsx)("span",{className:"absolute inset-0 flex items-center justify-center",children:"Saving"})]})})]}),(0,r.jsx)("div",{className:"space-y-0",children:[...to].map((e,t)=>{let l=e5(e.id,eY),a=eG.get(e.id),n=0,s=0;a&&a.forEach((e,t)=>{var l;n+=e;let r=(null==_?void 0:null===(l=_.holes.find(e=>e.holeNumber===t))||void 0===l?void 0:l.par)||4;s+=r});e6(e);let o=ti.findIndex(t=>t.id===e.id);return -1!==o&&ti[o].thru,(0,r.jsxs)("div",{className:"flex justify-between items-center bg-gray-50 rounded-xl py-0 px-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"flex flex-col items-start leading-tight",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("div",{className:"font-bold text-gray-900 text-[18pt] leading-tight",children:e4(e.name).first}),(()=>{let t=e8(e);if(!t)return null;let l=t.name.toLowerCase().includes("white")?"W":t.name.toLowerCase().includes("gold")?"G":t.name.charAt(0).toUpperCase(),a="W"===l?"bg-gray-200 text-gray-800":"G"===l?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-600";return(0,r.jsx)("span",{className:"text-[12pt] font-black px-1.5 rounded ".concat(a),children:l})})()]}),(0,r.jsx)("div",{className:"text-gray-700 text-[15pt] leading-tight",children:e4(e.name).last})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("button",{onClick:()=>tl(t,"up"),disabled:0===t,className:"w-8 h-8 rounded-full flex items-center justify-center shadow-md active:scale-95 transition-all ".concat(0===t?"bg-gray-300 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),title:"Move Up",children:(0,r.jsx)("svg",{viewBox:"0 0 24 24",className:"w-6 h-6",fill:"currentColor",children:(0,r.jsx)("path",{d:"M7 14l5-5 5 5z"})})}),(e.isGuest||e.id.startsWith("guest-"))&&e1&&(0,r.jsx)("button",{onClick:()=>{var t;ec({id:e.id,name:e.name,index:e.index,courseHandicap:(null===(t=e.liveRoundData)||void 0===t?void 0:t.course_hcp)||0}),es(!0)},className:"ml-1 text-blue-600 hover:text-blue-800 text-[12pt] font-semibold",children:""})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[e1&&(0,r.jsx)("button",{onClick:()=>ta(e.id,!1),className:"w-12 h-12 rounded-full bg-[#ff3b30] flex items-center justify-center text-white font-bold shadow-md active:scale-95 transition-transform text-[30pt]",children:"-"}),(0,r.jsx)("div",{className:"w-16 text-center font-bold text-[40pt] text-gray-800",children:l||(0,r.jsx)("span",{className:"text-gray-800",children:e2})}),e1&&(0,r.jsx)("button",{onClick:()=>ta(e.id,!0),className:"w-12 h-12 rounded-full bg-[#00c950] flex items-center justify-center text-white font-bold shadow-md active:scale-95 transition-transform text-[30pt]",children:"+"})]})]},e.id)})}),0===to.length&&(0,r.jsxs)("div",{className:"py-8 text-center bg-gray-50 rounded-xl border border-dashed border-gray-300 mb-2",children:[(0,r.jsx)("p",{className:"text-gray-500 font-bold text-[15pt] mb-4",children:"No players selected for scoring."}),(0,r.jsx)("button",{onClick:()=>eq(!0),className:"bg-black text-white px-6 py-2 rounded-full font-bold text-[15pt] shadow-md active:scale-95 transition-all",children:"Add Players / Join"})]})]}),(0,r.jsx)("div",{className:"pt-4"}),ts.length>0?(0,r.jsxs)("div",{id:"summary-section",className:"mt-1 space-y-2",children:[(0,r.jsxs)("div",{className:"flex gap-2 my-1",children:[(0,r.jsxs)("button",{onClick:()=>J.refresh(),className:"flex-1 bg-black text-white rounded-full py-2 text-[15pt] font-bold hover:bg-gray-800 transition-colors shadow-md active:scale-95",children:["Leaderboard (",ts.length,") - Refresh"]}),Y&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:async()=>{let e=I.find(e=>e.id===q),t=(null==e?void 0:e.name)||"Live Scorecard",l="".concat(t,"\n\nLeaderboard\n\n"),r='\n                                                <div style="font-family: sans-serif; background-image: linear-gradient(#ffffff, #ffffff) !important; background-color: #ffffff !important; color: #000000 !important; margin: 0; padding: 0;">\n                                                    \x3c!-- ID: '.concat(Date.now(),' --\x3e\n                                                    <meta name="color-scheme" content="light only">\n                                                    <meta name="supported-color-schemes" content="light only">\n                                                    <table width="100%" height="100%" bgcolor="#ffffff" cellpadding="0" cellspacing="0" border="0" style="background-image: linear-gradient(#ffffff, #ffffff) !important; background-color: #ffffff !important;">\n                                                        <tr>\n                                                            <td align="center" valign="top" style="padding: 1px; background-image: linear-gradient(#ffffff, #ffffff) !important; background-color: #ffffff !important;">\n                                                                <div style="max-width: 600px; text-align: center; margin: 0 auto; background-image: linear-gradient(#ffffff, #ffffff) !important; background-color: #ffffff !important;">\n                                                                    <h2 style="margin: 0; font-size: 11pt; font-weight: bold; color: #000000 !important;">').concat(t.replace("New Orleans",""),'</h2>\n                                                                    <br>\n                                                                    <h2 style="margin: 0; font-size: 11pt; font-weight: bold; color: #000000 !important;">Leaderboard</h2>\n                                                                </div>\n                                                ');ti.forEach((e,t)=>{var l,a;let n="E",s="#16a34a";e.toPar>0?(n="+".concat(e.toPar),s="#000000"):e.toPar<0&&(n="".concat(e.toPar),s="#dc2626");let{first:o,last:i}=e4(e.name),d=e8(e),c=d?d.name.toLowerCase().includes("white")?"W":d.name.toLowerCase().includes("gold")?"G":d.name.charAt(0).toUpperCase():"";r+='\n                                                    <table width="100%" bgcolor="#ffffff" cellpadding="0" cellspacing="0" border="0" style="box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-radius: 8px; margin-bottom: 8px; border: 2px solid #d1d5db;">\n                                                        <tr>\n                                                            <td>\n                                                                <div style="background: #1d4ed8; padding: 1px; color: white;">\n                                                                    <table width="100%" cellpadding="1" cellspacing="0" border="0" style="color: white;">\n                                                                        <tr>\n                                                                            <td align="left" style="vertical-align: middle; padding: 1px;">\n                                                                                <table cellpadding="1" cellspacing="0" border="0" style="color: white;">\n                                                                                    <tr>\n                                                                                        <td style="font-weight: bold; font-size: 13pt; line-height: 1.1; color: white;">'.concat(o,'</td>\n                                                                                        <td style="padding-left: 2px;">\n                                                                                            ').concat(c?'<span style="font-size: 11pt; font-weight: 900; padding: 1px 3px; border-radius: 2px; background: '.concat("W"===c?"#e5e7eb; color: #1f2937":"#fef3c7; color: #92400e",'; border: 1px solid #000;">').concat(c,"</span>"):"",'\n                                                                                        </td>\n                                                                                    </tr>\n                                                                                    <tr>\n                                                                                        <td colspan="2" style="font-size: 11pt; line-height: 1.1; opacity: 0.9; color: white;">').concat(i,'</td>\n                                                                                    </tr>\n                                                                                </table>\n                                                                            </td>\n                                                                            <td align="right" style="vertical-align: middle; padding: 1px;">\n                                                                                <table cellpadding="1" cellspacing="0" border="0" style="color: white;">\n                                                                                    <tr>\n                                                                                        <td style="background-image: linear-gradient(#ffffff, #ffffff) !important; background-color: #ffffff !important; color: ').concat(s,' !important; font-weight: bold; border-radius: 4px; padding: 2px 4px; font-size: 11pt; text-align: center; min-width: 40px; border: 1px solid #000;">\n                                                                                            ').concat(n,'\n                                                                                        </td>\n                                                                                        <td style="text-align: center; padding-left: 4px;">\n                                                                                            <div style="font-size: 11pt; font-weight: bold; opacity: 0.8; color: white;">GRS</div>\n                                                                                            <div style="font-size: 11pt; font-weight: bold; color: white;">').concat(e.totalGross,'</div>\n                                                                                        </td>\n                                                                                        <td style="text-align: center; padding-left: 4px;">\n                                                                                            <div style="font-size: 11pt; font-weight: bold; opacity: 0.8; color: white;">HCP</div>\n                                                                                            <div style="font-size: 11pt; font-weight: bold; color: white;">').concat(e.strokesReceivedSoFar,'</div>\n                                                                                        </td>\n                                                                                        <td style="text-align: center; padding-left: 4px;">\n                                                                                            <div style="font-size: 11pt; font-weight: bold; opacity: 0.8; color: white;">NET</div>\n                                                                                            <div style="font-size: 11pt; font-weight: bold; color: white;">').concat(e.totalNet,'</div>\n                                                                                        </td>\n                                                                                    </tr>\n                                                                                </table>\n                                                                            </td>\n                                                                        </tr>\n                                                                    </table>\n                                                                </div>\n                                                                <div style="padding: 1px; border-top: 1px solid #000;">\n                                                                    <table width="100%" cellpadding="1" cellspacing="0" border="0" style="border-collapse: collapse;" bgcolor="#ffffff">\n                                                                        <tr style="border-bottom: 1px solid #000;">\n                                                    ');for(let t=1;t<=9;t++){let a=e3(e.id,t),n=(null==_?void 0:null===(l=_.holes.find(e=>e.holeNumber===t))||void 0===l?void 0:l.par)||4,s="#ffffff";if(null!==a){let e=a-n;e<=-2?s="#fde047":-1===e?s="#86efac":0===e?s="#ffffff":1===e?s="#fed7aa":e>=2&&(s="#fca5a5")}r+='\n                                                            <td style="border-right: 1px solid #000; text-align: center; padding: 1px; background-image: linear-gradient('.concat(s,", ").concat(s,") !important; background-color: ").concat(s,' !important;" bgcolor="').concat(s,'">\n                                                                <div style="font-size: 11pt; color: #000000 !important; line-height: 1.1;">').concat(t,"/").concat(n,'</div>\n                                                                <div style="font-size: 11pt; font-weight: bold; color: #000000 !important; line-height: 1.1;">').concat(a||"-","</div>\n                                                            </td>\n                                                        ")}r+="</tr><tr>";for(let t=10;t<=18;t++){let l=e3(e.id,t),n=(null==_?void 0:null===(a=_.holes.find(e=>e.holeNumber===t))||void 0===a?void 0:a.par)||4,s="#ffffff";if(null!==l){let e=l-n;e<=-2?s="#fde047":-1===e?s="#86efac":0===e?s="#ffffff":1===e?s="#fed7aa":e>=2&&(s="#fca5a5")}r+='\n                                                            <td style="border-right: 1px solid #000; text-align: center; padding: 1px; background-image: linear-gradient('.concat(s,", ").concat(s,") !important; background-color: ").concat(s,' !important;" bgcolor="').concat(s,'">\n                                                                <div style="font-size: 11pt; color: #000000 !important; line-height: 1.1;">').concat(t,"/").concat(n,'</div>\n                                                                <div style="font-size: 11pt; font-weight: bold; color: #000000 !important; line-height: 1.1;">').concat(l||"-","</div>\n                                                            </td>\n                                                        ")}r+="</tr></table></div></td></tr></table>"}),r+='\n                                                            <div style="display:none; color: #ffffff !important; font-size: 1pt; overflow: hidden; height: 0; width: 0; line-height: 0;">ID: '.concat(Date.now(),"</div>\n                                                            </td>\n                                                        </tr>\n                                                    </table>\n                                                </div>");try{let e=new Blob([r],{type:"text/html"}),t=new Blob([l],{type:"text/plain"});await navigator.clipboard.write([new ClipboardItem({"text/html":e,"text/plain":t})]),eA("Copied!","Scorecard copied to clipboard")}catch(e){console.error("Failed to copy: ",e),eA("Error","Failed to copy scorecard")}},className:"flex items-center justify-center p-2 bg-black text-white rounded-full hover:bg-gray-800 transition-colors shadow-sm cursor-pointer",title:"Copy Scorecard",children:(0,r.jsx)(o.A,{size:20})}),(0,r.jsx)("button",{onClick:async()=>{if(!(null==E?void 0:E.players)){eA("No Players","No players found in this round.");return}let e=new Set;E.players.forEach(t=>{var l,r;if(null===(l=t.player)||void 0===l?void 0:l.email)e.add(t.player.email);else if(null===(r=t.player)||void 0===r?void 0:r.id){let l=C.find(e=>e.id===t.player.id);(null==l?void 0:l.email)&&e.add(l.email)}});let t=Array.from(e).join("; ");if(!t){eA("No Emails","No emails found for players in this round.");return}try{await navigator.clipboard.writeText(t),eA("Copied!","All player emails from the round copied to clipboard")}catch(e){console.error("Failed to copy emails: ",e),eA("Error","Failed to copy emails")}},className:"flex items-center justify-center p-2 bg-black text-white rounded-full hover:bg-gray-800 transition-colors shadow-sm cursor-pointer",title:"Copy Emails",children:(0,r.jsx)(i.A,{size:20})}),(0,r.jsx)("button",{onClick:async()=>{let e=I.find(e=>e.id===q),t=(null==e?void 0:e.name)||"Live Scorecard",l=new Set;(null==E?void 0:E.players)?E.players.forEach(e=>{var t,r;if(null===(t=e.player)||void 0===t?void 0:t.email)l.add(e.player.email);else if(null===(r=e.player)||void 0===r?void 0:r.id){let t=C.find(t=>t.id===e.player.id);(null==t?void 0:t.email)&&l.add(t.email)}}):ti.forEach(e=>{let t=C.find(t=>t.id===e.id);(null==t?void 0:t.email)?l.add(t.email):e.email&&l.add(e.email)});let r=Array.from(l).join("; ");if(!r){eA("No Emails","No player emails found to send to.");return}eB("Send Scorecard?","Send scorecard to: ".concat(r,"?"),async()=>{let e='\n                                                    <!DOCTYPE html>\n                                                    <html>\n                                                    <body style="margin:0;padding:0;background:#ffffff;font-family:Arial,Helvetica,sans-serif;">\n                                                    <table width="100%" cellpadding="0" cellspacing="0" bgcolor="#ffffff">\n                                                        <tr>\n                                                            <td align="center" style="padding: 0;">\n                                                                \x3c!-- CONTAINER --\x3e\n                                                                <table width="100%" cellpadding="0" cellspacing="0" style="max-width:600px;border-collapse:collapse;">\n                                                                    \x3c!-- TITLE --\x3e\n                                                                    <tr>\n                                                                        <td style="padding:12px;background:#000000;color:#ffffff;font-size:18px;font-weight:bold;text-align:center;">\n                                                                            '.concat(t.replace("New Orleans",""),"<br/>\n                                                                            Leaderboard\n                                                                            \x3c!-- ID: ").concat(Date.now()," --\x3e\n                                                                        </td>\n                                                                    </tr>\n                                                    ");ti.forEach((t,l)=>{var r,a;let{first:n,last:s}=e4(t.name),o=0;for(let e=1;e<=9;e++){let l=e3(t.id,e);l&&(o+=l)}let i=0;for(let e=10;e<=18;e++){let l=e3(t.id,e);l&&(i+=l)}let d=t.courseHcp,c=e8(t),x=c?c.name.toLowerCase().includes("white")?"W":c.name.toLowerCase().includes("gold")?"G":c.name.charAt(0).toUpperCase():"",u="E";t.toPar>0?u="+".concat(t.toPar):t.toPar<0&&(u="".concat(t.toPar)),e+='\n                                                        \x3c!-- PLAYER SPACER --\x3e\n                                                        <tr><td height="12"></td></tr>\n                                                        \n                                                        \x3c!-- PLAYER CARD --\x3e\n                                                        <tr>\n                                                            <td style="border:1px solid #CCCCCC;">\n                                                                <table width="100%" cellpadding="0" cellspacing="0" style="border-collapse:collapse;">\n                                                                    \x3c!-- PLAYER HEADER --\x3e\n                                                                    <tr>\n                                                                        <td style="padding:8px;background:#1F4FD8;background-image:linear-gradient(#1F4FD8,#1F4FD8);color:#ffffff;">\n                                                                            <table width="100%" cellpadding="0" cellspacing="0">\n                                                                                <tr>\n                                                                                    \x3c!-- NAME (Bottom-Left, Stacked) --\x3e\n                                                                                    <td style="color:#ffffff;font-size:16px;font-weight:bold;line-height:1.2;">\n                                                                                        '.concat(n,"<br/>\n                                                                                        ").concat(s,"\n                                                                                        ").concat(x?'<span style="background:#ffffff;color:#000;padding:1px 4px;border-radius:3px;font-size:10px;margin-left:4px;vertical-align:middle;">'.concat(x,"</span>"):"",'\n                                                                                    </td>\n                                                                                    \n                                                                                    \x3c!-- STATS (Right) --\x3e\n                                                                                    <td align="right" style="vertical-align:bottom;">\n                                                                                        <table cellpadding="0" cellspacing="0">\n                                                                                            <tr>\n                                                                                                \x3c!-- TO PAR BADGE --\x3e\n                                                                                                <td valign="bottom" style="padding-right:8px;padding-bottom:2px;">\n                                                                                                    <span style="background:#ffffff;color:#000000;padding:3px 6px;border-radius:4px;font-weight:bold;font-size:14px;display:inline-block;">').concat(u,'</span>\n                                                                                                </td>\n                                                                                                \n                                                                                                \x3c!-- STATS GRID --\x3e\n                                                                                                <td>\n                                                                                                    <table cellpadding="0" cellspacing="0">\n                                                                                                        <tr>\n                                                                                                            <td align="center" style="padding:0 4px;color:#cbd5e1;font-size:9px;font-weight:bold;text-transform:uppercase;">GRS</td>\n                                                                                                            <td align="center" style="padding:0 4px;color:#cbd5e1;font-size:9px;font-weight:bold;text-transform:uppercase;">HCP</td>\n                                                                                                            <td align="center" style="padding:0 4px;color:#cbd5e1;font-size:9px;font-weight:bold;text-transform:uppercase;">NET</td>\n                                                                                                        </tr>\n                                                                                                        <tr>\n                                                                                                            <td align="center" style="padding:0 4px;color:#ffffff;font-size:14px;font-weight:bold;">').concat(o,"+").concat(i,"=").concat(t.totalGross,'</td>\n                                                                                                            <td align="center" style="padding:0 4px;color:#ffffff;font-size:14px;font-weight:bold;">').concat(d,"/").concat(d,'</td>\n                                                                                                            <td align="center" style="padding:0 4px;color:#ffffff;font-size:14px;font-weight:bold;">').concat(t.totalNet,'</td>\n                                                                                                        </tr>\n                                                                                                    </table>\n                                                                                                </td>\n                                                                                            </tr>\n                                                                                        </table>\n                                                                                    </td>\n                                                                                </tr>\n                                                                            </table>\n                                                                        </td>\n                                                                    </tr>\n                                                                    \n                                                                    \x3c!-- SCORES --\x3e\n                                                                    <tr>\n                                                                        <td>\n                                                                            <table width="100%" cellpadding="0" cellspacing="0" style="border-collapse:collapse;table-layout:fixed;">\n                                                                                \x3c!-- Row 1: Front 9 --\x3e\n                                                                                <tr>\n                                                        ');for(let l=1;l<=9;l++){let a=e3(t.id,l),n=(null==_?void 0:null===(r=_.holes.find(e=>e.holeNumber===l))||void 0===r?void 0:r.par)||4,s="#F2F2F2",o="#000000";if(null!==a){let e=a-n;e<=-1?(s=e<=-2?"#fde047":"#86efac",o="#000000"):0===e?(s="#ffffff",o="#000000"):1===e?(s="#fed7aa",o="#000000"):e>=2&&(s="#fca5a5",o="#000000")}e+='\n                                                            <td style="border:1px solid #CCCCCC;background:'.concat(s,";background-image:linear-gradient(").concat(s,",").concat(s,');text-align:center;padding:8px 0;width:11.11%;">\n                                                                <div style="font-size:11px;color:').concat(o,';opacity:0.8;">').concat(l,"/").concat(n,'</div>\n                                                                <div style="font-size:14px;font-weight:bold;color:').concat(o,';">').concat(a||"-","</div>\n                                                            </td>\n                                                            ")}e+="</tr>\x3c!-- Row 2: Back 9 --\x3e<tr>";for(let l=10;l<=18;l++){let r=e3(t.id,l),n=(null==_?void 0:null===(a=_.holes.find(e=>e.holeNumber===l))||void 0===a?void 0:a.par)||4,s="#F2F2F2",o="#000000";if(null!==r){let e=r-n;e<=-1?(s=e<=-2?"#fde047":"#86efac",o="#000000"):0===e?(s="#ffffff",o="#000000"):1===e?(s="#fed7aa",o="#000000"):e>=2&&(s="#fca5a5",o="#000000")}e+='\n                                                            <td style="border:1px solid #CCCCCC;background:'.concat(s,";background-image:linear-gradient(").concat(s,",").concat(s,');text-align:center;padding:8px 0;width:11.11%;">\n                                                                <div style="font-size:11px;color:').concat(o,';opacity:0.8;">').concat(l,"/").concat(n,'</div>\n                                                                <div style="font-size:14px;font-weight:bold;color:').concat(o,';">').concat(r||"-","</div>\n                                                            </td>\n                                                            ")}e+="\n                                                                                </tr>\n                                                                            </table>\n                                                                        </td>\n                                                                    </tr>\n                                                                </table>\n                                                            </td>\n                                                        </tr>\n                                                        "}),e+='\n                                                                </table>\n                                                                \x3c!-- BOTTOM ID to prevent grouping --\x3e\n                                                                <div style="display:none;font-size:1px;color:#ffffff;">ID: '.concat(Date.now(),"</div>\n                                                            </td>\n                                                        </tr>\n                                                    </table>\n                                                    </body>\n                                                    </html>");let l=await U(r,"*** For Testing *** CPGC Leaderboard",e,"*** For Testing *** CPGC Leaderboard");l.success||eA("Failed","Error: ".concat(l.error))})},className:"flex items-center justify-center p-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors shadow-sm cursor-pointer",title:"Send Scorecard to All Players",children:(0,r.jsx)(d.A,{size:20})})]}),(0,r.jsx)("button",{onClick:()=>eg(!0),className:"w-16 h-12 bg-black text-white rounded-full flex items-center justify-center hover:bg-gray-800 transition-colors shadow-md active:scale-95",children:(0,r.jsx)(c.A,{size:32})}),(0,r.jsx)("button",{onClick:()=>eh(!0),className:"px-4 py-2 rounded-full text-[15pt] font-bold transition-colors shadow-sm cursor-pointer whitespace-nowrap bg-black text-white border-2 border-black hover:bg-gray-800",children:"$5 Pool"})]}),(0,r.jsx)("div",{className:"space-y-1",children:ti.map((e,t)=>{let l="E",a="text-green-600";return e.toPar>0?(l="+".concat(e.toPar),a="text-gray-900"):e.toPar<0&&(l="".concat(e.toPar),a="text-red-600"),e.thru,(0,r.jsxs)("div",{className:"bg-white text-black shadow-lg rounded-xl overflow-hidden my-1 border-4 border-gray-300",children:[(0,r.jsx)("div",{className:"bg-[#1d4ed8] p-1 text-white",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"font-bold text-[16pt] leading-tight flex items-center gap-1",children:[e4(e.name).first,(()=>{let t=e8(e);if(!t)return null;let l=t.name.toLowerCase().includes("white")?"W":t.name.toLowerCase().includes("gold")?"G":t.name.charAt(0).toUpperCase(),a="W"===l?"bg-gray-200 text-gray-800":"G"===l?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-600";return(0,r.jsx)("span",{className:"text-[10pt] font-black px-1.5 py-0.5 rounded ".concat(a),children:l})})()]}),(0,r.jsx)("div",{className:"text-[13pt] leading-tight opacity-90",children:e4(e.name).last})]}),(0,r.jsx)("div",{className:"flex items-center"})]}),(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsx)("div",{className:"bg-white font-bold rounded px-2 h-8 flex items-center justify-center text-[18pt] min-w-[3rem] ".concat(a),children:l}),(0,r.jsxs)("div",{className:"text-left",children:[(0,r.jsx)("div",{className:"text-[12pt] opacity-80 font-bold tracking-wider",children:"GRS"}),(0,r.jsx)("div",{className:"text-[15pt] font-bold leading-none",children:e.front9>0||e.back9>0?(0,r.jsxs)(r.Fragment,{children:[e.front9,"+",e.back9,"=",e.totalGross]}):(0,r.jsx)(r.Fragment,{children:e.totalGross})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-[12pt] opacity-80 font-bold tracking-wider",children:"HCP"}),(0,r.jsxs)("div",{className:"text-[15pt] font-bold leading-none",children:[e.strokesReceivedSoFar,"/",e.courseHcp]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-[12pt] opacity-80 font-bold tracking-wider",children:"NET"}),(0,r.jsx)("div",{className:"text-[15pt] font-bold leading-none",children:e.totalNet})]})]})]})}),(0,r.jsxs)("div",{className:"p-1 border border-black rounded shadow-sm overflow-hidden",children:[(0,r.jsx)("div",{className:"grid grid-cols-9 border-b border-black",children:[1,2,3,4,5,6,7,8,9].map(t=>{let l=e3(e.id,t),a=eY===t,n=null==_?void 0:_.holes.find(e=>e.holeNumber===t),s=(null==n?void 0:n.par)||4,o="bg-white";if(null!==l){let e=l-s;e<=-2?o="bg-yellow-300":-1===e?o="bg-green-300":0===e?o="bg-white":1===e?o="bg-orange-200":e>=2&&(o="bg-red-300")}else a&&(o="bg-green-50");return(0,r.jsxs)("div",{onClick:()=>{Y&&eE({playerId:e.id,holeNumber:t})},className:"\n                                                            flex flex-col items-center justify-center h-16 border-r border-black last:border-r-0 relative bg-white\n                                                            ".concat(a?"ring-2 ring-black ring-inset z-10":"","\n                                                            ").concat(Y?"cursor-pointer hover:bg-gray-50":"","\n                                                        "),children:[(0,r.jsxs)("div",{className:"absolute top-1 inset-x-0 flex justify-center px-1.5 text-gray-900 items-baseline gap-0.5",children:[(0,r.jsx)("span",{className:"text-[13pt] font-bold",children:t}),(0,r.jsxs)("span",{className:"text-[12pt] font-normal opacity-80",children:["/",s]})]}),Y&&(null==e_?void 0:e_.playerId)===e.id&&(null==e_?void 0:e_.holeNumber)===t?(0,r.jsx)("input",{type:"number",inputMode:"numeric",autoFocus:!0,"aria-label":"Score for hole ".concat(t),className:"text-[18pt] font-black w-full h-10 mt-6 text-center bg-blue-50 focus:outline-none border-t border-b border-blue-200 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",defaultValue:l||"",onFocus:e=>e.target.select(),onKeyDown:l=>{"Enter"===l.key?(tn(e.id,t,l.target.value),t<18?eE({playerId:e.id,holeNumber:t+1}):eE(null)):"Escape"===l.key&&eE(null)},onBlur:l=>{tn(e.id,t,l.target.value),setTimeout(()=>{eE(l=>(null==l?void 0:l.playerId)===e.id&&(null==l?void 0:l.holeNumber)===t?null:l)},100)}}):(0,r.jsx)("div",{className:"text-[16pt] font-bold px-2 py-0.5 rounded mt-7 ".concat(o," ").concat(null!==l?"text-gray-900 font-black":"text-gray-300 font-normal italic"),children:l||"-"})]},t)})}),(0,r.jsx)("div",{className:"grid grid-cols-9",children:[10,11,12,13,14,15,16,17,18].map(t=>{let l=e3(e.id,t),a=eY===t,n=null==_?void 0:_.holes.find(e=>e.holeNumber===t),s=(null==n?void 0:n.par)||4,o="bg-white";if(null!==l){let e=l-s;e<=-2?o="bg-yellow-300":-1===e?o="bg-green-300":0===e?o="bg-white":1===e?o="bg-orange-200":e>=2&&(o="bg-red-300")}else a&&(o="bg-green-50");return(0,r.jsxs)("div",{onClick:()=>{Y&&eE({playerId:e.id,holeNumber:t})},className:"\n                                                            flex flex-col items-center justify-center h-16 border-r border-black last:border-r-0 relative bg-white\n                                                            ".concat(a?"ring-2 ring-black ring-inset z-10":"","\n                                                            ").concat(Y?"cursor-pointer hover:bg-gray-50":"","\n                                                        "),children:[(0,r.jsxs)("div",{className:"absolute top-1 inset-x-0 flex justify-center px-1.5 text-gray-900 items-baseline gap-0.5",children:[(0,r.jsx)("span",{className:"text-[13pt] font-bold",children:t}),(0,r.jsxs)("span",{className:"text-[12pt] font-normal opacity-80",children:["/",s]})]}),Y&&(null==e_?void 0:e_.playerId)===e.id&&(null==e_?void 0:e_.holeNumber)===t?(0,r.jsx)("input",{type:"number",inputMode:"numeric",autoFocus:!0,"aria-label":"Score for hole ".concat(t),className:"text-[18pt] font-black w-full h-10 mt-6 text-center bg-blue-50 focus:outline-none border-t border-b border-blue-200 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",defaultValue:l||"",onFocus:e=>e.target.select(),onKeyDown:l=>{"Enter"===l.key?(tn(e.id,t,l.target.value),t<18?eE({playerId:e.id,holeNumber:t+1}):eE(null)):"Escape"===l.key&&eE(null)},onBlur:l=>{tn(e.id,t,l.target.value),setTimeout(()=>{eE(l=>(null==l?void 0:l.playerId)===e.id&&(null==l?void 0:l.holeNumber)===t?null:l)},100)}}):(0,r.jsx)("div",{className:"text-[16pt] font-bold px-2 py-0.5 rounded mt-7 ".concat(o," ").concat(null!==l?"text-gray-900 font-black":"text-gray-300 font-normal italic"),children:l||"-"})]},t)})})]})]},e.id)})})]}):(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-lg border-2 border-gray-300 p-8 text-center m-1",children:(0,r.jsx)("p",{className:"text-gray-500 font-bold text-[15pt]",children:"No players have joined this round yet."})},"no-players"),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-2 m-1 flex flex-wrap gap-x-6 gap-y-2 items-center justify-center text-[15pt]",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-5 h-5 rounded-full bg-yellow-300 shadow-sm"}),"(-2)"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-5 h-5 rounded-full bg-green-300 shadow-sm"}),"(-1)"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-5 h-5 rounded-full bg-white border-2 border-gray-300 shadow-sm"}),"(E)"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-5 h-5 rounded-full bg-orange-200 shadow-sm"}),"(+1)"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-5 h-5 rounded-full bg-red-300 shadow-sm"}),"(+2)"]})]})]}),(0,r.jsx)(y,{isOpen:ex,onClose:()=>eu(!1),players:Y?ti:ti.filter(e=>to.some(t=>t.id===e.id)),liveRoundId:q||"",onSave:tt}),ep&&(0,r.jsxs)("div",{className:"fixed inset-0 z-[300] bg-gray-50 overflow-y-auto",children:[(0,r.jsx)("div",{className:"bg-white shadow-sm sticky top-0 z-10 px-1 py-3 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h1",{className:"text-[18pt] font-bold text-gray-900 tracking-tight text-left ml-3",children:"Round Stats"}),(0,r.jsx)("button",{onClick:()=>eg(!1),className:"px-1 py-2 bg-black text-white rounded-full text-[14pt] font-bold hover:bg-gray-800 transition-colors mr-3",children:"Close"})]})}),(0,r.jsxs)("div",{className:"p-3 space-y-4",children:[(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-3 border-2 border-green-500",children:[(0,r.jsxs)("h2",{className:"text-[16pt] font-bold text-green-700 mb-3 flex items-center gap-2",children:[(0,r.jsx)(c.A,{size:32,className:"text-green-600"})," Birdies (1 Under Par)"]}),(0,r.jsx)("div",{className:"space-y-2",children:tx.length>0?tx.map(e=>(0,r.jsxs)("div",{className:"flex justify-between items-center bg-green-50 rounded-lg p-2",children:[(0,r.jsx)("span",{className:"text-[15pt] font-bold text-gray-900",children:e.name}),(0,r.jsx)("span",{className:"text-[18pt] font-black text-green-700",children:e.birdieCount})]},e.id)):(0,r.jsx)("p",{className:"text-gray-500 text-center py-4",children:"No birdies yet"})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-3 border-2 border-yellow-500",children:[(0,r.jsx)("h2",{className:"text-[16pt] font-bold text-yellow-700 mb-3 flex items-center gap-2",children:"\uD83E\uDD85 Eagles (2 Under Par)"}),(0,r.jsx)("div",{className:"space-y-2",children:tu.length>0?tu.map(e=>(0,r.jsxs)("div",{className:"flex justify-between items-center bg-yellow-50 rounded-lg p-2",children:[(0,r.jsx)("span",{className:"text-[15pt] font-bold text-gray-900",children:e.name}),(0,r.jsx)("span",{className:"text-[18pt] font-black text-yellow-700",children:e.eagleCount})]},e.id)):(0,r.jsx)("p",{className:"text-gray-500 text-center py-4",children:"No eagles yet"})})]})]})]}),ev.length>0&&(0,r.jsx)("div",{className:"fixed inset-0 z-[400] flex items-center justify-center bg-black/70 animate-in fade-in duration-300",onClick:()=>ey([]),children:(0,r.jsx)("div",{className:"animate-in zoom-in-95 duration-500 flex flex-col items-center gap-4",onClick:e=>e.stopPropagation(),children:(0,r.jsxs)("div",{className:"bg-white text-black rounded-2xl px-6 py-4 shadow-2xl flex flex-col items-center max-w-sm mx-4 border-4 border-green-500",children:[(0,r.jsx)("div",{className:"text-[100pt] leading-none mb-2",children:"\uD83D\uDC26"}),(0,r.jsx)("h1",{className:"text-[30pt] font-black text-green-600 mb-4 text-center leading-tight drop-shadow-sm uppercase italic",children:"Beautiful Birdie!"}),(0,r.jsx)("div",{className:"text-[18pt] font-bold text-gray-900 text-center mb-4 w-full",children:[...ev].sort((e,t)=>t.totalBirdies-e.totalBirdies).map((e,t)=>(0,r.jsxs)("div",{className:"mb-2 last:mb-0 border-b last:border-0 border-gray-100 pb-2 last:pb-0",children:[(0,r.jsx)("div",{className:"leading-tight",children:e.name}),(0,r.jsxs)("div",{className:"text-[14pt] text-green-600 font-bold leading-tight",children:[e.totalBirdies," ",1===e.totalBirdies?"Birdie":"Birdies"," Total"]})]},t))}),(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),ey([])},className:"w-full bg-black text-white rounded-full py-2 text-[15pt] font-bold hover:bg-gray-800 transition-colors shadow-md active:scale-95",children:"Close"})]})})}),ew.length>0&&(0,r.jsx)("div",{className:"fixed inset-0 z-[400] flex items-center justify-center bg-black/70 animate-in fade-in duration-300",onClick:()=>ej([]),children:(0,r.jsx)("div",{className:"animate-in zoom-in-95 duration-500 flex flex-col items-center gap-4",onClick:e=>e.stopPropagation(),children:(0,r.jsxs)("div",{className:"bg-white text-black rounded-2xl px-6 py-4 shadow-2xl flex flex-col items-center max-w-sm mx-4 border-4 border-yellow-400",children:[(0,r.jsx)("div",{className:"text-[100pt] leading-none mb-2",children:"\uD83E\uDD85"}),(0,r.jsx)("h1",{className:"text-[30pt] font-black text-yellow-500 mb-4 text-center leading-tight drop-shadow-sm uppercase italic",children:"Awesome Eagle!"}),(0,r.jsx)("div",{className:"text-[18pt] font-bold text-gray-900 text-center mb-4 w-full",children:[...ew].sort((e,t)=>t.totalEagles-e.totalEagles).map((e,t)=>(0,r.jsxs)("div",{className:"mb-2 last:mb-0 border-b last:border-0 border-gray-100 pb-2 last:pb-0",children:[(0,r.jsx)("div",{className:"leading-tight",children:e.name}),(0,r.jsxs)("div",{className:"text-[14pt] text-yellow-600 font-bold leading-tight",children:[e.totalEagles," ",1===e.totalEagles?"Eagle":"Eagles"," Total"]})]},t))}),(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),ej([])},className:"w-full bg-black text-white rounded-full py-2 text-[15pt] font-bold hover:bg-gray-800 transition-colors shadow-md active:scale-95",children:"Close"})]})})}),ex&&(0,r.jsx)(y,{isOpen:ex,onClose:()=>eu(!1),onSave:async()=>{eu(!1)},players:C,liveRoundId:q||""}),ef&&q&&(0,r.jsx)(D,{roundId:q,isOpen:ef,onClose:()=>eh(!1)}),eM&&(0,r.jsx)(b,{isOpen:eM.isOpen,title:eM.title,message:eM.message,isDestructive:eM.isDestructive,confirmText:eM.confirmText,cancelText:eM.cancelText,hideCancel:eM.hideCancel,onConfirm:eM.onConfirm,onCancel:()=>eF(null)})]}):(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 pb-20",children:[(0,r.jsx)("header",{className:"bg-white shadow-sm sticky top-0 z-50 px-4 py-3 flex justify-between items-center",children:(0,r.jsx)("h1",{className:"text-xl font-bold text-green-700",children:"Live Scoring"})}),(0,r.jsx)("main",{className:"p-4 flex flex-col items-center justify-center mt-10 space-y-6",children:(0,r.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-lg border-2 border-dashed border-gray-300 text-center max-w-sm w-full",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"No Active Round"}),(0,r.jsx)("p",{className:"text-gray-500 mb-6",children:"There is no round currently in progress."}),(0,r.jsx)("button",{onClick:()=>{ea("new"),el(!0)},className:"w-full bg-green-600 text-white text-lg font-bold py-3 rounded-xl shadow-md hover:bg-green-700 transition",children:"Start New Round"}),I.length>0&&(0,r.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-100",children:[(0,r.jsx)("label",{className:"block text-sm font-bold text-gray-500 mb-2",children:"Or Resume Existing Round:"}),(0,r.jsxs)("select",{className:"w-full p-2 border rounded-lg bg-gray-50 text-lg text-black","aria-label":"Resume Existing Round",title:"Resume Existing Round",onChange:e=>{e.target.value&&(window.location.href="/live?roundId=".concat(e.target.value))},defaultValue:"",children:[(0,r.jsx)("option",{value:"",disabled:!0,children:"-- Select Round --"}),I.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[545,441,517,358],()=>t(9181)),_N_E=e.O()}]);